{"version":3,"sources":["webpack://bluebutton/webpack/universalModuleDefinition","webpack://bluebutton/webpack/bootstrap","webpack://bluebutton/./lib/core.js","webpack://bluebutton/./lib/parsers/generic.js","webpack://bluebutton/./lib/parsers/ccda/demographics.js","webpack://bluebutton/./lib/core/common.js","webpack://bluebutton/./lib/parsers/ccdar2/health_concerns.js","webpack://bluebutton/./lib/bluebutton.js","webpack://bluebutton/./lib/core/codes.js","webpack://bluebutton/./lib/core/xml.js","webpack://bluebutton/(webpack)/buildin/global.js","webpack://bluebutton/./node_modules/process/browser.js","webpack://bluebutton/external \"xmldom\"","webpack://bluebutton/./lib/documents.js","webpack://bluebutton/./lib/documents/c32.js","webpack://bluebutton/./lib/documents/ccd.js","webpack://bluebutton/./lib/documents/ccda.js","webpack://bluebutton/./lib/documents/ccdar2.js","webpack://bluebutton/./lib/generators.js","webpack://bluebutton/./lib/generators/c32.js","webpack://bluebutton/./lib/generators/ccda.js","webpack://bluebutton/external \"lodash\"","webpack://bluebutton/./lib/parsers.js","webpack://bluebutton/./lib/parsers/c32.js","webpack://bluebutton/./lib/parsers/c32/allergies.js","webpack://bluebutton/./lib/parsers/c32/demographics.js","webpack://bluebutton/./lib/parsers/c32/document.js","webpack://bluebutton/./lib/parsers/c32/encounters.js","webpack://bluebutton/./lib/parsers/c32/immunizations.js","webpack://bluebutton/./lib/parsers/c32/medications.js","webpack://bluebutton/./lib/parsers/c32/problems.js","webpack://bluebutton/./lib/parsers/c32/procedures.js","webpack://bluebutton/./lib/parsers/c32/results.js","webpack://bluebutton/./lib/parsers/c32/vitals.js","webpack://bluebutton/./lib/parsers/ccd.js","webpack://bluebutton/./lib/parsers/ccd/document.js","webpack://bluebutton/./lib/parsers/ccda.js","webpack://bluebutton/./lib/parsers/ccda/allergies.js","webpack://bluebutton/./lib/parsers/ccda/care_plan.js","webpack://bluebutton/./lib/parsers/ccda/document.js","webpack://bluebutton/./lib/parsers/ccda/encounters.js","webpack://bluebutton/./lib/parsers/ccda/free_text.js","webpack://bluebutton/./lib/parsers/ccda/functional_statuses.js","webpack://bluebutton/./lib/parsers/ccda/immunizations.js","webpack://bluebutton/./lib/parsers/ccda/instructions.js","webpack://bluebutton/./lib/parsers/ccda/medications.js","webpack://bluebutton/./lib/parsers/ccda/problems.js","webpack://bluebutton/./lib/parsers/ccda/procedures.js","webpack://bluebutton/./lib/parsers/ccda/results.js","webpack://bluebutton/./lib/parsers/ccda/smoking_status.js","webpack://bluebutton/./lib/parsers/ccda/vitals.js","webpack://bluebutton/./lib/parsers/ccdar2.js","webpack://bluebutton/./lib/parsers/ccdar2/document.js"],"names":["Codes","require","XML","stripWhitespace","module","exports","parseData","json","trim","source","charAt","parse","e","console","log","JSON","error","datePad","number","replacerFn","key","value","originalValue","Date","isNaN","getTime","_parsedWithTimeData","getHours","getMinutes","getSeconds","getMilliseconds","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getMonth","getDate","getFullYear","stringify","o","y","x","hasOwnProperty","Object","ccda","data","each","callback","i","length","containsTemplateId","templateId","property","p","allSections","elsByTag","s","code","tag","attr","existingTemplateId","nodeName","split","join","toLowerCase","displayName","text","val","Core","doc","self","demographics","parseDate","parseName","parseAddress","el","section","patient","patient_name_dict","dob","gender","marital_status","maritalStatus","patient_address_dict","home","work","mobile","email","language","race","ethnicity","religion","birthplace_dict","guardian_relationship","guardian_relationship_code","guardian_home","guardian_name_dict","guardian_address_dict","provider_organization","provider_phone","provider_address_dict","name","address","phone","birthplace","state","zip","country","guardian","given","family","relationship","relationship_code","provider","organization","str","replace","health_concerns_document","model","entries","health_concerns","title","entry","entryModel","act","er","id","statusCode","effectiveTime","actModel","effective_time","entry_relationship","ers","erModel","type_code","observations","obs","ob","push","class_code","mood_code","display_name","status","Documents","Generators","Parsers","opts","type","parsedData","parsedDocument","parser","documents","detect","parsers","C32","process","run","CCDA","CCDAR2","CCD","generatorType","template","testingMode","GENDER_MAP","MARITAL_STATUS_MAP","RELIGION_MAP","RACE_ETHNICITY_MAP","ROLE_MAP","PROBLEM_STATUS_MAP","invertKeys","obj","result","keys","lookupFnGenerator","map","reverseLookupFnGenerator","invertedMap","reverseGender","reverseMaritalStatus","reverseReligion","raceEthnicity","reverseRaceEthnicity","role","reverseRole","problemStatus","reverseProblemStatus","wrapElement","wrapElementHelper","currentEl","content","immediateChildTag","boolAttr","isEmpty","els","tagAttrVal","getElementsByTagName","getAttribute","emptyEl","parentNode","contentId","unescapeSpecialChars","attrName","attrVal","rawAttr","html","childNodes","textContent","innerHTML","root","XMLSerializer","serializeToString","tagName","slice","docRoot","ownerDocument","contentTag","createElement","xml","isNode","xmldom","DOMParser","parseFromString","window","ActiveXObject","async","loadXML","documentElement","global","document","prototype","toString","call","DOMImplementation","createDocument","getEntries","year","substr","month","parseInt","day","hour","min","secs","utcOffset","_utcOffsetFromString","_toInt","date","UTC","parseTimezoneChunker","parseTokenTimezone","string","possibleTzMatches","match","tzChunk","parts","minutes","argumentForCoercion","coercedNumber","isFinite","Math","floor","ceil","nameEl","prefix","addrEl","street","city","c32","method","_","now","filename","bb","tagHelpers","ejs","helpers","codes","AllergiesParser","DemographicsParser","DocumentParser","EncountersParser","ImmunizationsParser","MedicationsParser","ProblemsParser","ProceduresParser","ResultsParser","VitalsParser","ParseGenericInfo","allergiesParser","demographicsParser","encountersParser","immunizationsParser","medicationsParser","problemsParser","proceduresParser","resultsParser","vitalsParser","allergies","encounters","parsedImmunizations","immunizations","administered","immunization_declines","declined","results","medications","problems","procedures","vitals","smoking_status","code_system","code_system_name","chief_complaint","care_plan","instructions","functional_statuses","start_date","end_date","reaction_type_name","reaction_type_code","reaction_type_code_system","reaction_type_code_system_name","reaction_name","reaction_code","reaction_code_system","severity","allergen_name","allergen_code","allergen_code_system","allergen_code_system_name","date_range","start","end","reaction","reaction_type","allergen","templates","rootTemplate","secondTemplate","loinc","nonXml","nonXmlNodes","bodyType","nonXmlBody","mediaType","representation","rawText","reference","docType","rootTemplateId","author","name_dict","address_dict","work_phone","documentation_of_list","performers","performer_name_dict","performer_phone","performer_addr","location_name","location_addr_dict","encounter_date","documentation_of","location","code_system_version","translation_name","translation_code","translation_code_system","translation_code_system_name","performer_name","performer_code","performer_code_system","performer_code_system_name","location_dict","findings","findingEls","translation","performer","administeredData","declinedData","product","product_name","product_code","product_code_system","product_code_system_name","lot_number","manufacturer_name","route_name","route_code","route_code_system","route_code_system_name","instructions_text","education_name","education_code","education_code_system","dose_value","dose_unit","dose_quantity","unit","route","education_type","effectiveTimes","schedule_type","schedule_period_value","schedule_period_unit","institutionSpecified","product_original_text","rate_quantity_value","rate_quantity_unit","precondition_name","precondition_code","precondition_code_system","reason_name","reason_code","reason_code_system","vehicle_name","vehicle_code","vehicle_code_system","vehicle_code_system_name","administration_name","administration_code","administration_code_system","administration_code_system_name","prescriber_organization","prescriber_person","rate_quantity","precondition","reason","schedule","period_value","period_unit","vehicle","administration","prescriber","person","age","parseFloat","comment","specimen_name","specimen_code","specimen_code_system","performer_dict","device_name","device_code","device_code_system","specimen","device","panel_date","panel_name","panel_code","panel_code_system","panel_code_system_name","observation","tests","tests_data","reference_range_text","reference_range_low_unit","reference_range_low_value","reference_range_high_unit","reference_range_high_value","reference_range","low_unit","low_value","high_unit","high_value","entry_date","results_data","j","HealthConcernsParser","documentParser","healthConcernsParser","CarePlanParser","FreeTextParser","FunctionalStatusesParser","InstructionsParser","SmokingStatusParser","carePlanParser","freeTextParser","functionalStatusesParser","instructionsParser","smokingStatusParser","free_text","time","m","d","D","org","undefined","orgEl","representedOrganization","sectionName","statuses","sig","social_history"],"mappings":"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AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qCAAqC;;AAErC;AACA;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA;AACA,4BAA4B,UAAU;;;;;;;ACvLtC,mC;;;;;;ACAA;;;AAGA,IAAIiJ,GAAG,GAAG3J,mBAAO,CAAC,EAAD,CAAjB;;AACA,IAAIgK,GAAG,GAAGhK,mBAAO,CAAC,EAAD,CAAjB;;AACA,IAAI8J,IAAI,GAAG9J,mBAAO,CAAC,EAAD,CAAlB;;AACA,IAAI+J,MAAM,GAAG/J,mBAAO,CAAC,EAAD,CAApB;;AAEAG,MAAM,CAACC,OAAP,GAAiB,YAAW;AAC1B,MAAImE,IAAI,GAAG,IAAX;AAEAA,MAAI,CAACkF,MAAL,GAAcA,MAAd;AACAlF,MAAI,CAACiD,OAAL,GAAeA,OAAf;AACAjD,MAAI,CAACE,SAAL,GAAiBA,SAAjB;AACAF,MAAI,CAACG,SAAL,GAAiBA,SAAjB;AACAH,MAAI,CAACI,YAAL,GAAoBA,YAApB;AACAJ,MAAI,CAACoF,GAAL,GAAW,IAAIA,GAAJ,CAAQgF,UAAR,CAAX;AACApK,MAAI,CAACyF,GAAL,GAAW,IAAIA,GAAJ,CAAQ2E,UAAR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","file":"bluebutton.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"bluebutton\"] = factory();\n\telse\n\t\troot[\"bluebutton\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","/*\r\n * ...\r\n */\r\n\r\nvar Codes = require('./core/codes');\r\nvar XML = require('./core/xml');\r\nvar { stripWhitespace } = require('./core/common');\r\n\r\n/* exported Core */\r\nmodule.exports = {\r\n  parseData: parseData,\r\n  stripWhitespace: stripWhitespace,\r\n  json: json,\r\n  trim: trim,\r\n  Codes: Codes,\r\n  XML: XML\r\n};\r\n/*\r\n  * ...\r\n  */\r\nfunction parseData(source) {\r\n  source = stripWhitespace(source);\r\n  \r\n  if (source.charAt(0) === '<') {\r\n    try {\r\n      return XML.parse(source);\r\n    } catch (e) {\r\n      if (console.log) {\r\n        console.log(\"File looked like it might be XML but couldn't be parsed.\");\r\n      }\r\n    }\r\n  }\r\n\r\n  try {\r\n    return JSON.parse(source);\r\n  } catch (e) {\r\n    if (console.error) {\r\n      console.error(\"Error: Cannot parse this file. BB.js only accepts valid XML \" +\r\n        \"(for parsing) or JSON (for generation). If you are attempting to provide \" +\r\n        \"XML or JSON, please run your data through a validator to see if it is malformed.\\n\");\r\n    }\r\n    throw e;\r\n  }\r\n};\r\n\r\n/*\r\n  * A wrapper around JSON.stringify which allows us to produce customized JSON.\r\n  *\r\n  * See https://developer.mozilla.org/en-US/docs/Web/\r\n  *        JavaScript/Guide/Using_native_JSON#The_replacer_parameter\r\n  * for documentation on the replacerFn.\r\n  */\r\nfunction json() {\r\n\r\n  var datePad = function(number) {\r\n    if (number < 10) {\r\n      return '0' + number;\r\n    }\r\n    return number;\r\n  };\r\n  \r\n  var replacerFn = function(key, value) {\r\n    /* By default, Dates are output as ISO Strings like \"2014-01-03T08:00:00.000Z.\" This is\r\n      * tricky when all we have is a date (not a datetime); JS sadly ignores that distinction.\r\n      *\r\n      * To paper over this JS wart, we use two different JSON formats for dates and datetimes.\r\n      * This is a little ugly but makes sure that the dates/datetimes mostly just parse\r\n      * correclty for clients:\r\n      *\r\n      * 1. Datetimes are rendered as standard ISO strings, without the misleading millisecond\r\n      *    precision (misleading because we don't have it): YYYY-MM-DDTHH:mm:ssZ\r\n      * 2. Dates are rendered as MM/DD/YYYY. This ensures they are parsed as midnight local-time,\r\n      *    no matter what local time is, and therefore ensures the date is always correct.\r\n      *    Outputting \"YYYY-MM-DD\" would lead most browsers/node to assume midnight UTC, which\r\n      *    means \"2014-04-27\" suddenly turns into \"04/26/2014 at 5PM\" or just \"04/26/2014\"\r\n      *    if you format it as a date...\r\n      *\r\n      * See http://stackoverflow.com/questions/2587345/javascript-date-parse and\r\n      *     http://blog.dygraphs.com/2012/03/javascript-and-dates-what-mess.html\r\n      * for more on this issue.\r\n      */\r\n    var originalValue = this[key]; // a Date\r\n\r\n    if ( value && (originalValue instanceof Date) && !isNaN(originalValue.getTime()) ) {\r\n\r\n      // If while parsing we indicated that there was time-data specified, or if we see\r\n      // non-zero values in the hour/minutes/seconds/millis fields, output a datetime.\r\n      if (originalValue._parsedWithTimeData ||\r\n          originalValue.getHours() || originalValue.getMinutes() ||\r\n          originalValue.getSeconds() || originalValue.getMilliseconds()) {\r\n\r\n        // Based on https://developer.mozilla.org/en-US/docs/Web/JavaScript/\r\n        //    Reference/Global_Objects/Date/toISOString\r\n        return originalValue.getUTCFullYear() +\r\n          '-' + datePad( originalValue.getUTCMonth() + 1 ) +\r\n          '-' + datePad( originalValue.getUTCDate() ) +\r\n          'T' + datePad( originalValue.getUTCHours() ) +\r\n          ':' + datePad( originalValue.getUTCMinutes() ) +\r\n          ':' + datePad( originalValue.getUTCSeconds() ) +\r\n          'Z';\r\n      }\r\n      \r\n      // We just have a pure date\r\n      return datePad( originalValue.getMonth() + 1 ) +\r\n        '/' + datePad( originalValue.getDate() ) +\r\n        '/' + originalValue.getFullYear();\r\n\r\n    }\r\n\r\n    return value;\r\n  };\r\n  \r\n  return JSON.stringify(this, replacerFn, 2);\r\n};\r\n\r\n\r\n/*\r\n  * Removes all `null` properties from an object.\r\n  */\r\nfunction trim(o) {\r\n  var y;\r\n  for (var x in o) {\r\n    if (o.hasOwnProperty(x)) {\r\n      y = o[x];\r\n      // if (y === null || (y instanceof Object && Object.keys(y).length == 0)) {\r\n      if (y === null) {\r\n        delete o[x];\r\n      }\r\n      if (y instanceof Object) y = trim(y);\r\n    }\r\n  }\r\n  return o;\r\n};\r\n","/* Parses out basic data about each section */\r\n\r\nmodule.exports = function (ccda, data) {\r\n\r\n    var each = function (callback) {\r\n        for (var i = 0; i < this.length; i++) {\r\n            callback(this[i]);\r\n        }\r\n    };\r\n\r\n    var containsTemplateId = function(templateId, data) {\r\n        for (var property in data) {\r\n            if (data.hasOwnProperty(property)) {\r\n                var p = data[property].templateId;\r\n                //var display = this[property].displayName;\r\n                if(p) {\r\n                    if(p === templateId) {\r\n                        //console.log(\"TemplateId Match \" + templateId + \" \" + display);\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    var allSections = ccda.elsByTag('section');\r\n    allSections.each = each;\r\n\r\n    allSections.each(function(s) {\r\n\r\n        var code = s.tag('code').attr('displayName');\r\n        var templateId =  s.tag('templateId').attr('root');\r\n\r\n        var existingTemplateId = containsTemplateId(templateId, data);\r\n\r\n        if (code) {\r\n            var nodeName = code.split(' ').join('_').toLowerCase();\r\n\r\n            //console.log(\"NODE NAME \" + nodeName);\r\n\r\n            if (!data[nodeName] && !existingTemplateId) {\r\n                //console.log(\"CREATE NODE \" + code);\r\n                data[nodeName] = {};\r\n            }\r\n\r\n            if(data[nodeName]) {\r\n                data[nodeName].displayName = code;\r\n                data[nodeName].templateId = templateId;\r\n                data[nodeName].text = s.tag('text').val(true);\r\n            }\r\n\r\n        }\r\n    });\r\n};","/*\r\n * Parser for the CCDA demographics section\r\n */\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n  self.demographics = demographics;\r\n\r\n  function demographics(ccda) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var data = {}, el;\r\n    \r\n    var demographics = ccda.section('demographics');\r\n    \r\n    var patient = demographics.tag('patientRole');\r\n    el = patient.tag('patient').tag('name');\r\n    var patient_name_dict = parseName(el);\r\n    \r\n    el = patient.tag('patient');\r\n    var dob = parseDate(el.tag('birthTime').attr('value')),\r\n        gender = Core.Codes.gender(el.tag('administrativeGenderCode').attr('code')),\r\n        marital_status = Core.Codes.maritalStatus(el.tag('maritalStatusCode').attr('code'));\r\n    \r\n    el = patient.tag('addr');\r\n    var patient_address_dict = parseAddress(el);\r\n    \r\n    el = patient.tag('telecom');\r\n    var home = el.attr('value'),\r\n        work = null,\r\n        mobile = null;\r\n    \r\n    var email = null;\r\n    \r\n    var language = patient.tag('languageCommunication').tag('languageCode').attr('code'),\r\n        race = patient.tag('raceCode').attr('displayName'),\r\n        ethnicity = patient.tag('ethnicGroupCode').attr('displayName'),\r\n        religion = patient.tag('religiousAffiliationCode').attr('displayName');\r\n    \r\n    el = patient.tag('birthplace');\r\n    var birthplace_dict = parseAddress(el);\r\n    \r\n    el = patient.tag('guardian');\r\n    var guardian_relationship = el.tag('code').attr('displayName'),\r\n        guardian_relationship_code = el.tag('code').attr('code'),\r\n        guardian_home = el.tag('telecom').attr('value');\r\n    \r\n    el = el.tag('guardianPerson').tag('name');\r\n    var guardian_name_dict = parseName(el);\r\n    \r\n    el = patient.tag('guardian').tag('addr');\r\n    var guardian_address_dict = parseAddress(el);\r\n    \r\n    el = patient.tag('providerOrganization');\r\n    var provider_organization = el.tag('name').val(),\r\n        provider_phone = el.tag('telecom').attr('value');\r\n    \r\n    var provider_address_dict = parseAddress(el.tag('addr'));\r\n    \r\n    data = {\r\n      name: patient_name_dict,\r\n      dob: dob,\r\n      gender: gender,\r\n      marital_status: marital_status,\r\n      address: patient_address_dict,\r\n      phone: {\r\n        home: home,\r\n        work: work,\r\n        mobile: mobile\r\n      },\r\n      email: email,\r\n      language: language,\r\n      race: race,\r\n      ethnicity: ethnicity,\r\n      religion: religion,\r\n      birthplace: {\r\n        state: birthplace_dict.state,\r\n        zip: birthplace_dict.zip,\r\n        country: birthplace_dict.country\r\n      },\r\n      guardian: {\r\n        name: {\r\n          given: guardian_name_dict.given,\r\n          family: guardian_name_dict.family\r\n        },\r\n        relationship: guardian_relationship,\r\n        relationship_code: guardian_relationship_code,\r\n        address: guardian_address_dict,\r\n        phone: {\r\n          home: guardian_home\r\n        }\r\n      },\r\n      provider: {\r\n        organization: provider_organization,\r\n        phone: provider_phone,\r\n        address: provider_address_dict\r\n      }\r\n    };\r\n    \r\n    return data;\r\n  };\r\n}","module.exports = {\r\n  stripWhitespace: stripWhitespace\r\n}\r\n\r\nfunction stripWhitespace (str) {\r\n    if (!str) { return str; }\r\n    return str.replace(/^\\s+|\\s+$/g,'');\r\n};","/*\r\n * Parser for the CCDAR2 Health Concerns Section\r\n * 2.16.840.1.113883.10.20.22.2.58\r\n */\r\n\r\nmodule.exports = function(doc) {\r\n    var self = this;\r\n    self.doc = doc;\r\n\r\n    self.health_concerns_document = function (ccda) {\r\n        var parseDate = self.doc.parseDate;\r\n        var parseName = self.doc.parseName;\r\n        var parseAddress = self.doc.parseAddress;\r\n    \r\n        // Helper to create each iterator for collection\r\n        var each = function (callback) {\r\n            for (var i = 0; i < this.length; i++) {\r\n                callback(this[i]);\r\n            }\r\n        };\r\n    \r\n        var model = {}, el;\r\n        model.entries = [];\r\n    \r\n        model.text = ccda.tag('text').val(true);\r\n    \r\n        var health_concerns = ccda.section('health_concerns_document');\r\n        var title = health_concerns.tag('title').val();\r\n    \r\n        health_concerns.entries().each(function(entry) {\r\n    \r\n            var entryModel = {};\r\n            // Parse out the ACT Body\r\n            //A record of something that is being done, has been done, can be done, or is intended or requested to be done.\r\n            var act = entry.tag('act');\r\n            var er = act.elsByTag('entryRelationship');\r\n            var templateId = act.tag('templateId').attr('root');\r\n            var id = act.tag('id').attr('root');\r\n            var statusCode = act.tag('statusCode').attr('code');\r\n            var code = act.tag('code');\r\n            var name = code.attr('displayName');\r\n            var effectiveTime = parseDate(entry.tag('effectiveTime'));\r\n    \r\n            // The model we want to return in json\r\n            var actModel = {\r\n                effective_time: effectiveTime,\r\n                name: name,\r\n                entry_relationship:[]\r\n            };\r\n    \r\n            // Parse Entity Relationship child nodes\r\n    \r\n            var ers = entry.elsByTag('entryRelationship');\r\n            ers.each = each;\r\n    \r\n            ers.each(function(er){\r\n    \r\n                var erModel = {\r\n                    type_code : er.attr('typeCode'),\r\n                    observations : []\r\n                };\r\n    \r\n                var obs = er.elsByTag('observation');\r\n                obs.each = each;\r\n    \r\n                // Parse out Obsevations for Each ER\r\n                obs.each(function(ob) {\r\n                    erModel.observations.push({\r\n                        class_code: ob.attr('classCode'),\r\n                        mood_code: ob.attr('moodCode'),\r\n                        display_name : ob.tag('value').attr('displayName'),\r\n                        status: ob.tag('statusCode').attr('code')\r\n                    });\r\n                });\r\n    \r\n                actModel.entry_relationship.push(erModel);\r\n    \r\n            });\r\n    \r\n            // Add ACT Model to our final return model\r\n            entryModel['act'] = actModel;\r\n            model.entries.push(entryModel);\r\n        });\r\n    \r\n        return model;\r\n    };    \r\n}","'use strict';\r\n/*\r\n * ...\r\n */\r\n\r\nvar Core = require('./core');\r\n\r\nvar Documents = require('./documents');\r\n\r\nvar Generators = require('./generators');\r\n\r\nvar Parsers = require('./parsers');\r\n\r\n\r\n/* exported BlueButton */\r\nmodule.exports = function (source, opts) {\r\n  var type, parsedData, parsedDocument;\r\n  \r\n  // Look for options\r\n  if (!opts) opts = {};\r\n  \r\n  // Detect and parse the source data\r\n  parsedData = Core.parseData(source);\r\n  \r\n  // Detect and parse the document\r\n  if (opts.parser) {\r\n    \r\n    // TODO: parse the document with provided custom parser\r\n    parsedDocument = opts.parser();\r\n    \r\n  } else {\r\n    var documents = new Documents();\r\n    type = documents.detect(parsedData);\r\n    var parsers = new Parsers(documents);\r\n    switch (type) {\r\n      case 'c32':\r\n        parsedData = documents.C32.process(parsedData);\r\n        parsedDocument = parsers.C32.run(parsedData);\r\n        break;\r\n      case 'ccda':\r\n        parsedData = documents.CCDA.process(parsedData);\r\n        parsedDocument = parsers.CCDA.run(parsedData);\r\n        break;\r\n      case 'ccdar2':\r\n        parsedData = documents.CCDAR2.process(parsedData);\r\n        parsedDocument = parsers.CCDAR2.run(parsedData);\r\n        break;\r\n      case 'ccd':\r\n        parsedData = documents.CCD.process(parsedData);\r\n        parsedDocument = parsers.CCD.run(parsedData);\r\n        break;\r\n      case 'json':\r\n        /* Expects a call like:\r\n         * BlueButton(json string, {\r\n         *   generatorType: 'ccda',\r\n         *   template: < EJS file contents >\r\n         * })\r\n         * The returned \"type\" will be the requested type (not \"json\")\r\n         * and the XML will be turned as a string in the 'data' key\r\n         */\r\n        switch (opts.generatorType) {\r\n          // only the unit tests ever need to worry about this testingMode argument\r\n          case 'c32':\r\n            type = 'c32';\r\n            parsedDocument = Generators.C32.run(parsedData, opts.template, opts.testingMode);\r\n            break;\r\n          case 'ccda':\r\n            type = 'ccda';\r\n            parsedDocument = Generators.CCDA.run(parsedData, opts.template, opts.testingMode);\r\n            break;\r\n        }\r\n    }\r\n  }\r\n  \r\n  return {\r\n    type: type,\r\n    data: parsedDocument,\r\n    source: parsedData\r\n  };\r\n\r\n};\r\n","/*\r\n * ...\r\n */\r\n\r\n\r\n  \r\n/*\r\n  * Administrative Gender (HL7 V3)\r\n  * http://phinvads.cdc.gov/vads/ViewValueSet.action?id=8DE75E17-176B-DE11-9B52-0015173D1785\r\n  * OID: 2.16.840.1.113883.1.11.1\r\n  */\r\nvar GENDER_MAP = {\r\n  'F': 'female',\r\n  'M': 'male',\r\n  'UN': 'undifferentiated'\r\n};\r\n\r\n/*\r\n  * Marital Status (HL7)\r\n  * http://phinvads.cdc.gov/vads/ViewValueSet.action?id=46D34BBC-617F-DD11-B38D-00188B398520\r\n  * OID: 2.16.840.1.114222.4.11.809\r\n  */\r\nvar MARITAL_STATUS_MAP = {\r\n  'N': 'annulled',\r\n  'C': 'common law',\r\n  'D': 'divorced',\r\n  'P': 'domestic partner',\r\n  'I': 'interlocutory',\r\n  'E': 'legally separated',\r\n  'G': 'living together',\r\n  'M': 'married',\r\n  'O': 'other',\r\n  'R': 'registered domestic partner',\r\n  'A': 'separated',\r\n  'S': 'single',\r\n  'U': 'unknown',\r\n  'B': 'unmarried',\r\n  'T': 'unreported',\r\n  'W': 'widowed'\r\n};\r\n\r\n/*\r\n  * Religious Affiliation (HL7 V3)\r\n  * https://phinvads.cdc.gov/vads/ViewValueSet.action?id=6BFDBFB5-A277-DE11-9B52-0015173D1785\r\n  * OID: 2.16.840.1.113883.5.1076\r\n  */\r\nvar RELIGION_MAP = {\r\n  \"1001\": \"adventist\",\r\n  \"1002\": \"african religions\",\r\n  \"1003\": \"afro-caribbean religions\",\r\n  \"1004\": \"agnosticism\",\r\n  \"1005\": \"anglican\",\r\n  \"1006\": \"animism\",\r\n  \"1061\": \"assembly of god\",\r\n  \"1007\": \"atheism\",\r\n  \"1008\": \"babi & baha'i faiths\",\r\n  \"1009\": \"baptist\",\r\n  \"1010\": \"bon\",\r\n  \"1062\": \"brethren\",\r\n  \"1011\": \"cao dai\",\r\n  \"1012\": \"celticism\",\r\n  \"1013\": \"christian (non-catholic, non-specific)\",\r\n  \"1063\": \"christian scientist\",\r\n  \"1064\": \"church of christ\",\r\n  \"1065\": \"church of god\",\r\n  \"1014\": \"confucianism\",\r\n  \"1066\": \"congregational\",\r\n  \"1015\": \"cyberculture religions\",\r\n  \"1067\": \"disciples of christ\",\r\n  \"1016\": \"divination\",\r\n  \"1068\": \"eastern orthodox\",\r\n  \"1069\": \"episcopalian\",\r\n  \"1070\": \"evangelical covenant\",\r\n  \"1017\": \"fourth way\",\r\n  \"1018\": \"free daism\",\r\n  \"1071\": \"friends\",\r\n  \"1072\": \"full gospel\",\r\n  \"1019\": \"gnosis\",\r\n  \"1020\": \"hinduism\",\r\n  \"1021\": \"humanism\",\r\n  \"1022\": \"independent\",\r\n  \"1023\": \"islam\",\r\n  \"1024\": \"jainism\",\r\n  \"1025\": \"jehovah's witnesses\",\r\n  \"1026\": \"judaism\",\r\n  \"1027\": \"latter day saints\",\r\n  \"1028\": \"lutheran\",\r\n  \"1029\": \"mahayana\",\r\n  \"1030\": \"meditation\",\r\n  \"1031\": \"messianic judaism\",\r\n  \"1073\": \"methodist\",\r\n  \"1032\": \"mitraism\",\r\n  \"1074\": \"native american\",\r\n  \"1075\": \"nazarene\",\r\n  \"1033\": \"new age\",\r\n  \"1034\": \"non-roman catholic\",\r\n  \"1035\": \"occult\",\r\n  \"1036\": \"orthodox\",\r\n  \"1037\": \"paganism\",\r\n  \"1038\": \"pentecostal\",\r\n  \"1076\": \"presbyterian\",\r\n  \"1039\": \"process, the\",\r\n  \"1077\": \"protestant\",\r\n  \"1078\": \"protestant, no denomination\",\r\n  \"1079\": \"reformed\",\r\n  \"1040\": \"reformed/presbyterian\",\r\n  \"1041\": \"roman catholic church\",\r\n  \"1080\": \"salvation army\",\r\n  \"1042\": \"satanism\",\r\n  \"1043\": \"scientology\",\r\n  \"1044\": \"shamanism\",\r\n  \"1045\": \"shiite (islam)\",\r\n  \"1046\": \"shinto\",\r\n  \"1047\": \"sikism\",\r\n  \"1048\": \"spiritualism\",\r\n  \"1049\": \"sunni (islam)\",\r\n  \"1050\": \"taoism\",\r\n  \"1051\": \"theravada\",\r\n  \"1081\": \"unitarian universalist\",\r\n  \"1052\": \"unitarian-universalism\",\r\n  \"1082\": \"united church of christ\",\r\n  \"1053\": \"universal life church\",\r\n  \"1054\": \"vajrayana (tibetan)\",\r\n  \"1055\": \"veda\",\r\n  \"1056\": \"voodoo\",\r\n  \"1057\": \"wicca\",\r\n  \"1058\": \"yaohushua\",\r\n  \"1059\": \"zen buddhism\",\r\n  \"1060\": \"zoroastrianism\"\r\n};\r\n\r\n/*\r\n  * Race & Ethnicity (HL7 V3)\r\n  * Full list at http://phinvads.cdc.gov/vads/ViewCodeSystem.action?id=2.16.840.1.113883.6.238\r\n  * OID: 2.16.840.1.113883.6.238\r\n  *\r\n  * Abbreviated list closer to real usage at: (Race / Ethnicity)\r\n  * https://phinvads.cdc.gov/vads/ViewValueSet.action?id=67D34BBC-617F-DD11-B38D-00188B398520\r\n  * https://phinvads.cdc.gov/vads/ViewValueSet.action?id=35D34BBC-617F-DD11-B38D-00188B398520\r\n  */\r\nvar RACE_ETHNICITY_MAP = {\r\n  '2028-9': 'asian',\r\n  '2054-5': 'black or african american',\r\n  '2135-2': 'hispanic or latino',\r\n  '2076-8': 'native',\r\n  '2186-5': 'not hispanic or latino',\r\n  '2131-1': 'other',\r\n  '2106-3': 'white'\r\n};\r\n\r\n/*\r\n  * Role (HL7 V3)\r\n  * https://phinvads.cdc.gov/vads/ViewCodeSystem.action?id=2.16.840.1.113883.5.111\r\n  * OID: 2.16.840.1.113883.5.111\r\n  */\r\nvar ROLE_MAP = {\r\n  \"ACC\": \"accident site\",\r\n  \"ACHFID\":  \"accreditation location identifier\",\r\n  \"ACTMIL\":  \"active duty military\",\r\n  \"ALL\": \"allergy clinic\",\r\n  \"AMB\": \"ambulance\",\r\n  \"AMPUT\":   \"amputee clinic\",\r\n  \"ANTIBIOT\":    \"antibiotic\",\r\n  \"ASSIST\":  \"assistive non-person living subject\",\r\n  \"AUNT\":    \"aunt\",\r\n  \"B\":   \"blind\",\r\n  \"BF\":  \"beef\",\r\n  \"BILL\":    \"billing contact\",\r\n  \"BIOTH\":   \"biotherapeutic non-person living subject\",\r\n  \"BL\":  \"broiler\",\r\n  \"BMTC\":    \"bone marrow transplant clinic\",\r\n  \"BMTU\":    \"bone marrow transplant unit\",\r\n  \"BR\":  \"breeder\",\r\n  \"BREAST\":  \"breast clinic\",\r\n  \"BRO\": \"brother\",\r\n  \"BROINLAW\":    \"brother-in-law\",\r\n  \"C\":   \"calibrator\",\r\n  \"CANC\": \"child and adolescent neurology clinic\",\r\n  \"CAPC\": \"child and adolescent psychiatry clinic\",\r\n  \"CARD\": \"ambulatory health care facilities; clinic/center; rehabilitation: cardiac facilities\",\r\n  \"CAS\": \"asylum seeker\",\r\n  \"CASM\":    \"single minor asylum seeker\",\r\n  \"CATH\":    \"cardiac catheterization lab\",\r\n  \"CCO\": \"clinical companion\",\r\n  \"CCU\": \"coronary care unit\",\r\n  \"CHEST\":   \"chest unit\",\r\n  \"CHILD\":   \"child\",\r\n  \"CHLDADOPT\":   \"adopted child\",\r\n  \"CHLDFOST\":    \"foster child\",\r\n  \"CHLDINLAW\":   \"child in-law\",\r\n  \"CHR\": \"chronic care facility\",\r\n  \"CLAIM\":   \"claimant\",\r\n  \"CN\":  \"national\",\r\n  \"CNRP\":    \"non-country member without residence permit\",\r\n  \"CNRPM\":   \"non-country member minor without residence permit\",\r\n  \"CO\":  \"companion\",\r\n  \"COAG\":    \"coagulation clinic\",\r\n  \"COCBEN\":  \"continuity of coverage beneficiary\",\r\n  \"COMM\":    \"community location\",\r\n  \"COMMUNITYLABORATORY\": \"community laboratory\",\r\n  \"COUSN\":   \"cousin\",\r\n  \"CPCA\":    \"permit card applicant\",\r\n  \"CRIMEVIC\":    \"crime victim\",\r\n  \"CRP\": \"non-country member with residence permit\",\r\n  \"CRPM\":    \"non-country member minor with residence permit\",\r\n  \"CRS\": \"colon and rectal surgery clinic\",\r\n  \"CSC\": \"community service center\",\r\n  \"CVDX\":    \"cardiovascular diagnostics or therapeutics unit\",\r\n  \"DA\":  \"dairy\",\r\n  \"DADDR\":   \"delivery address\",\r\n  \"DAU\": \"natural daughter\",\r\n  \"DAUADOPT\":    \"adopted daughter\",\r\n  \"DAUC\":    \"daughter\",\r\n  \"DAUFOST\": \"foster daughter\",\r\n  \"DAUINLAW\":    \"daughter in-law\",\r\n  \"DC\":  \"therapeutic class\",\r\n  \"DEBR\":    \"debridement\",\r\n  \"DERM\":    \"dermatology clinic\",\r\n  \"DIFFABL\": \"differently abled\",\r\n  \"DOMPART\": \"domestic partner\",\r\n  \"DPOWATT\": \"durable power of attorney\",\r\n  \"DR\":  \"draft\",\r\n  \"DU\":  \"dual\",\r\n  \"DX\":  \"diagnostics or therapeutics unit\",\r\n  \"E\":   \"electronic qc\",\r\n  \"ECHO\":    \"echocardiography lab\",\r\n  \"ECON\":    \"emergency contact\",\r\n  \"ENDO\":    \"endocrinology clinic\",\r\n  \"ENDOS\":   \"endoscopy lab\",\r\n  \"ENROLBKR\":    \"enrollment broker\",\r\n  \"ENT\": \"otorhinolaryngology clinic\",\r\n  \"EPIL\":    \"epilepsy unit\",\r\n  \"ER\":  \"emergency room\",\r\n  \"ERL\": \"enrollment\",\r\n  \"ETU\": \"emergency trauma unit\",\r\n  \"EXCEST\":  \"executor of estate\",\r\n  \"EXT\": \"extended family member\",\r\n  \"F\":   \"filler proficiency\",\r\n  \"FAMDEP\":  \"family dependent\",\r\n  \"FAMMEMB\": \"family member\",\r\n  \"FI\":  \"fiber\",\r\n  \"FMC\": \"family medicine clinic\",\r\n  \"FRND\":    \"unrelated friend\",\r\n  \"FSTUD\":   \"full-time student\",\r\n  \"FTH\": \"father\",\r\n  \"FTHINLAW\":    \"father-in-law\",\r\n  \"FULLINS\": \"fully insured coverage sponsor\",\r\n  \"G\":   \"group\",\r\n  \"GACH\":    \"hospitals; general acute care hospital\",\r\n  \"GD\":  \"generic drug\",\r\n  \"GDF\": \"generic drug form\",\r\n  \"GDS\": \"generic drug strength\",\r\n  \"GDSF\":    \"generic drug strength form\",\r\n  \"GGRFTH\":  \"great grandfather\",\r\n  \"GGRMTH\":  \"great grandmother\",\r\n  \"GGRPRN\":  \"great grandparent\",\r\n  \"GI\":  \"gastroenterology clinic\",\r\n  \"GIDX\":    \"gastroenterology diagnostics or therapeutics lab\",\r\n  \"GIM\": \"general internal medicine clinic\",\r\n  \"GRFTH\":   \"grandfather\",\r\n  \"GRMTH\":   \"grandmother\",\r\n  \"GRNDCHILD\":   \"grandchild\",\r\n  \"GRNDDAU\": \"granddaughter\",\r\n  \"GRNDSON\": \"grandson\",\r\n  \"GRPRN\":   \"grandparent\",\r\n  \"GT\":  \"guarantor\",\r\n  \"GUADLTM\": \"guardian ad lidem\",\r\n  \"GUARD\":   \"guardian\",\r\n  \"GYN\": \"gynecology clinic\",\r\n  \"HAND\":    \"hand clinic\",\r\n  \"HANDIC\":  \"handicapped dependent\",\r\n  \"HBRO\":    \"half-brother\",\r\n  \"HD\":  \"hemodialysis unit\",\r\n  \"HEM\": \"hematology clinic\",\r\n  \"HLAB\":    \"hospital laboratory\",\r\n  \"HOMEHEALTH\":  \"home health\",\r\n  \"HOSP\":    \"hospital\",\r\n  \"HPOWATT\": \"healthcare power of attorney\",\r\n  \"HRAD\":    \"radiology unit\",\r\n  \"HSIB\":    \"half-sibling\",\r\n  \"HSIS\":    \"half-sister\",\r\n  \"HTN\": \"hypertension clinic\",\r\n  \"HU\":  \"hospital unit\",\r\n  \"HUSB\":    \"husband\",\r\n  \"HUSCS\":   \"specimen collection site\",\r\n  \"ICU\": \"intensive care unit\",\r\n  \"IEC\": \"impairment evaluation center\",\r\n  \"INDIG\":   \"member of an indigenous people\",\r\n  \"INFD\":    \"infectious disease clinic\",\r\n  \"INJ\": \"injured plaintiff\",\r\n  \"INJWKR\":  \"injured worker\",\r\n  \"INLAB\":   \"inpatient laboratory\",\r\n  \"INPHARM\": \"inpatient pharmacy\",\r\n  \"INV\": \"infertility clinic\",\r\n  \"JURID\":   \"jurisdiction location identifier\",\r\n  \"L\":   \"pool\",\r\n  \"LABORATORY\":  \"laboratory\",\r\n  \"LOCHFID\": \"local location identifier\",\r\n  \"LY\":  \"layer\",\r\n  \"LYMPH\":   \"lympedema clinic\",\r\n  \"MAUNT\":   \"maternalaunt\",\r\n  \"MBL\": \"medical laboratory\",\r\n  \"MCOUSN\":  \"maternalcousin\",\r\n  \"MGDSF\":   \"manufactured drug strength form\",\r\n  \"MGEN\":    \"medical genetics clinic\",\r\n  \"MGGRFTH\": \"maternalgreatgrandfather\",\r\n  \"MGGRMTH\": \"maternalgreatgrandmother\",\r\n  \"MGGRPRN\": \"maternalgreatgrandparent\",\r\n  \"MGRFTH\":  \"maternalgrandfather\",\r\n  \"MGRMTH\":  \"maternalgrandmother\",\r\n  \"MGRPRN\":  \"maternalgrandparent\",\r\n  \"MHSP\":    \"military hospital\",\r\n  \"MIL\": \"military\",\r\n  \"MOBL\":    \"mobile unit\",\r\n  \"MT\":  \"meat\",\r\n  \"MTH\": \"mother\",\r\n  \"MTHINLAW\":    \"mother-in-law\",\r\n  \"MU\":  \"multiplier\",\r\n  \"MUNCLE\":  \"maternaluncle\",\r\n  \"NBOR\":    \"neighbor\",\r\n  \"NBRO\":    \"natural brother\",\r\n  \"NCCF\":    \"nursing or custodial care facility\",\r\n  \"NCCS\":    \"neurology critical care and stroke unit\",\r\n  \"NCHILD\":  \"natural child\",\r\n  \"NEPH\":    \"nephrology clinic\",\r\n  \"NEPHEW\":  \"nephew\",\r\n  \"NEUR\":    \"neurology clinic\",\r\n  \"NFTH\":    \"natural father\",\r\n  \"NFTHF\":   \"natural father of fetus\",\r\n  \"NIECE\":   \"niece\",\r\n  \"NIENEPH\": \"niece/nephew\",\r\n  \"NMTH\":    \"natural mother\",\r\n  \"NOK\": \"next of kin\",\r\n  \"NPRN\":    \"natural parent\",\r\n  \"NS\":  \"neurosurgery unit\",\r\n  \"NSIB\":    \"natural sibling\",\r\n  \"NSIS\":    \"natural sister\",\r\n  \"O\":   \"operator proficiency\",\r\n  \"OB\":  \"obstetrics clinic\",\r\n  \"OF\":  \"outpatient facility\",\r\n  \"OMS\": \"oral and maxillofacial surgery clinic\",\r\n  \"ONCL\":    \"medical oncology clinic\",\r\n  \"OPH\": \"opthalmology clinic\",\r\n  \"OPTC\":    \"optometry clinic\",\r\n  \"ORG\": \"organizational contact\",\r\n  \"ORTHO\":   \"orthopedics clinic\",\r\n  \"OUTLAB\":  \"outpatient laboratory\",\r\n  \"OUTPHARM\":    \"outpatient pharmacy\",\r\n  \"P\":   \"patient\",\r\n  \"PAINCL\":  \"pain clinic\",\r\n  \"PATHOLOGIST\": \"pathologist\",\r\n  \"PAUNT\":   \"paternalaunt\",\r\n  \"PAYOR\":   \"payor contact\",\r\n  \"PC\":  \"primary care clinic\",\r\n  \"PCOUSN\":  \"paternalcousin\",\r\n  \"PEDC\":    \"pediatrics clinic\",\r\n  \"PEDCARD\": \"pediatric cardiology clinic\",\r\n  \"PEDE\":    \"pediatric endocrinology clinic\",\r\n  \"PEDGI\":   \"pediatric gastroenterology clinic\",\r\n  \"PEDHEM\":  \"pediatric hematology clinic\",\r\n  \"PEDHO\":   \"pediatric oncology clinic\",\r\n  \"PEDICU\":  \"pediatric intensive care unit\",\r\n  \"PEDID\":   \"pediatric infectious disease clinic\",\r\n  \"PEDNEPH\": \"pediatric nephrology clinic\",\r\n  \"PEDNICU\": \"pediatric neonatal intensive care unit\",\r\n  \"PEDRHEUM\":    \"pediatric rheumatology clinic\",\r\n  \"PEDU\":    \"pediatric unit\",\r\n  \"PGGRFTH\": \"paternalgreatgrandfather\",\r\n  \"PGGRMTH\": \"paternalgreatgrandmother\",\r\n  \"PGGRPRN\": \"paternalgreatgrandparent\",\r\n  \"PGRFTH\":  \"paternalgrandfather\",\r\n  \"PGRMTH\":  \"paternalgrandmother\",\r\n  \"PGRPRN\":  \"paternalgrandparent\",\r\n  \"PH\":  \"policy holder\",\r\n  \"PHARM\":   \"pharmacy\",\r\n  \"PHLEBOTOMIST\":    \"phlebotomist\",\r\n  \"PHU\": \"psychiatric hospital unit\",\r\n  \"PL\":  \"pleasure\",\r\n  \"PLS\": \"plastic surgery clinic\",\r\n  \"POD\": \"podiatry clinic\",\r\n  \"POWATT\":  \"power of attorney\",\r\n  \"PRC\": \"pain rehabilitation center\",\r\n  \"PREV\":    \"preventive medicine clinic\",\r\n  \"PRN\": \"parent\",\r\n  \"PRNINLAW\":    \"parent in-law\",\r\n  \"PROCTO\":  \"proctology clinic\",\r\n  \"PROFF\":   \"provider's office\",\r\n  \"PROG\":    \"program eligible\",\r\n  \"PROS\":    \"prosthodontics clinic\",\r\n  \"PSI\": \"psychology clinic\",\r\n  \"PSTUD\":   \"part-time student\",\r\n  \"PSY\": \"psychiatry clinic\",\r\n  \"PSYCHF\":  \"psychiatric care facility\",\r\n  \"PT\":  \"patient\",\r\n  \"PTRES\":   \"patient's residence\",\r\n  \"PUNCLE\":  \"paternaluncle\",\r\n  \"Q\":   \"quality control\",\r\n  \"R\":   \"replicate\",\r\n  \"RADDX\":   \"radiology diagnostics or therapeutics unit\",\r\n  \"RADO\":    \"radiation oncology unit\",\r\n  \"RC\":  \"racing\",\r\n  \"RESPRSN\": \"responsible party\",\r\n  \"RETIREE\": \"retiree\",\r\n  \"RETMIL\":  \"retired military\",\r\n  \"RH\":  \"rehabilitation hospital\",\r\n  \"RHAT\":    \"addiction treatment center\",\r\n  \"RHEUM\":   \"rheumatology clinic\",\r\n  \"RHII\":    \"intellectual impairment center\",\r\n  \"RHMAD\":   \"parents with adjustment difficulties center\",\r\n  \"RHPI\":    \"physical impairment center\",\r\n  \"RHPIH\":   \"physical impairment - hearing center\",\r\n  \"RHPIMS\":  \"physical impairment - motor skills center\",\r\n  \"RHPIVS\":  \"physical impairment - visual skills center\",\r\n  \"RHU\": \"rehabilitation hospital unit\",\r\n  \"RHYAD\":   \"youths with adjustment difficulties center\",\r\n  \"RNEU\":    \"neuroradiology unit\",\r\n  \"ROOM\":    \"roommate\",\r\n  \"RTF\": \"residential treatment facility\",\r\n  \"SCHOOL\":  \"school\",\r\n  \"SCN\": \"screening\",\r\n  \"SEE\": \"seeing\",\r\n  \"SELF\":    \"self\",\r\n  \"SELFINS\": \"self insured coverage sponsor\",\r\n  \"SH\":  \"show\",\r\n  \"SIB\": \"sibling\",\r\n  \"SIBINLAW\":    \"sibling in-law\",\r\n  \"SIGOTHR\": \"significant other\",\r\n  \"SIS\": \"sister\",\r\n  \"SISINLAW\":    \"sister-in-law\",\r\n  \"SLEEP\":   \"sleep disorders unit\",\r\n  \"SNF\": \"skilled nursing facility\",\r\n  \"SNIFF\":   \"sniffing\",\r\n  \"SON\": \"natural son\",\r\n  \"SONADOPT\":    \"adopted son\",\r\n  \"SONC\":    \"son\",\r\n  \"SONFOST\": \"foster son\",\r\n  \"SONINLAW\":    \"son in-law\",\r\n  \"SPMED\":   \"sports medicine clinic\",\r\n  \"SPON\":    \"sponsored dependent\",\r\n  \"SPOWATT\": \"special power of attorney\",\r\n  \"SPS\": \"spouse\",\r\n  \"STPBRO\":  \"stepbrother\",\r\n  \"STPCHLD\": \"step child\",\r\n  \"STPDAU\":  \"stepdaughter\",\r\n  \"STPFTH\":  \"stepfather\",\r\n  \"STPMTH\":  \"stepmother\",\r\n  \"STPPRN\":  \"step parent\",\r\n  \"STPSIB\":  \"step sibling\",\r\n  \"STPSIS\":  \"stepsister\",\r\n  \"STPSON\":  \"stepson\",\r\n  \"STUD\":    \"student\",\r\n  \"SU\":  \"surgery clinic\",\r\n  \"SUBJECT\": \"self\",\r\n  \"SURF\":    \"substance use rehabilitation facility\",\r\n  \"THIRDPARTY\":  \"third party\",\r\n  \"TPA\": \"third party administrator\",\r\n  \"TR\":  \"transplant clinic\",\r\n  \"TRAVEL\":  \"travel and geographic medicine clinic\",\r\n  \"TRB\": \"tribal member\",\r\n  \"UMO\": \"utilization management organization\",\r\n  \"UNCLE\":   \"uncle\",\r\n  \"UPC\": \"underage protection center\",\r\n  \"URO\": \"urology clinic\",\r\n  \"V\":   \"verifying\",\r\n  \"VET\": \"veteran\",\r\n  \"VL\":  \"veal\",\r\n  \"WARD\":    \"ward\",\r\n  \"WIFE\":    \"wife\",\r\n  \"WL\":  \"wool\",\r\n  \"WND\": \"wound clinic\",\r\n  \"WO\":  \"working\",\r\n  \"WORK\":    \"work site\",\r\n};\r\n\r\nvar PROBLEM_STATUS_MAP = {\r\n  \"55561003\": \"active\",\r\n  \"73425007\": \"inactive\",\r\n  \"413322009\": \"resolved\"\r\n};\r\n\r\n\r\n// copied from _.invert to avoid making browser users include all of underscore\r\nvar invertKeys = function(obj) {\r\n  var result = {};\r\n  var keys = Object.keys(obj);\r\n  for (var i = 0, length = keys.length; i < length; i++) {\r\n    result[obj[keys[i]]] = keys[i];\r\n  }\r\n  return result;\r\n};\r\n\r\nvar lookupFnGenerator = function(map) {\r\n  return function(key) {\r\n    return map[key] || null;\r\n  };\r\n};\r\nvar reverseLookupFnGenerator = function(map) {\r\n  return function(key) {\r\n    if (!key) { return null; }\r\n    var invertedMap = invertKeys(map);\r\n    key = key.toLowerCase();\r\n    return invertedMap[key] || null;\r\n  };\r\n};\r\n\r\n\r\nmodule.exports =  {\r\n  gender: lookupFnGenerator(GENDER_MAP),\r\n  reverseGender: reverseLookupFnGenerator(GENDER_MAP),\r\n  maritalStatus: lookupFnGenerator(MARITAL_STATUS_MAP),\r\n  reverseMaritalStatus: reverseLookupFnGenerator(MARITAL_STATUS_MAP),\r\n  religion: lookupFnGenerator(RELIGION_MAP),\r\n  reverseReligion: reverseLookupFnGenerator(RELIGION_MAP),\r\n  raceEthnicity: lookupFnGenerator(RACE_ETHNICITY_MAP),\r\n  reverseRaceEthnicity: reverseLookupFnGenerator(RACE_ETHNICITY_MAP),\r\n  role: lookupFnGenerator(ROLE_MAP),\r\n  reverseRole: reverseLookupFnGenerator(ROLE_MAP),\r\n  problemStatus: lookupFnGenerator(PROBLEM_STATUS_MAP),\r\n  reverseProblemStatus: reverseLookupFnGenerator(PROBLEM_STATUS_MAP)\r\n};\r\n","/*\r\n * ...\r\n */\r\nvar { stripWhitespace } = require('./common');\r\n/*\r\n  * A function used to wrap DOM elements in an object so methods can be added\r\n  * to the element object. IE8 does not allow methods to be added directly to\r\n  * DOM objects.\r\n  */\r\nvar wrapElement = function (el) {\r\n  function wrapElementHelper(currentEl) {\r\n    return {\r\n      el: currentEl,\r\n      template: template,\r\n      content: content,\r\n      tag: tag,\r\n      immediateChildTag: immediateChildTag,\r\n      elsByTag: elsByTag,\r\n      attr: attr,\r\n      boolAttr: boolAttr,\r\n      val: val,\r\n      isEmpty: isEmpty\r\n    };\r\n  }\r\n  \r\n  // el is an array of elements\r\n  if (el.length) {\r\n    var els = [];\r\n    for (var i = 0; i < el.length; i++) {\r\n      els.push(wrapElementHelper(el[i]));\r\n    }\r\n    return els;\r\n  \r\n  // el is a single element\r\n  } else {\r\n    return wrapElementHelper(el);\r\n  }\r\n};\r\n\r\n\r\n/*\r\n  * Find element by tag name, then attribute value.\r\n  */\r\nvar tagAttrVal = function (el, tag, attr, value) {\r\n  el = el.getElementsByTagName(tag);\r\n  for (var i = 0; i < el.length; i++) {\r\n    if (el[i].getAttribute(attr) === value) {\r\n      return el[i];\r\n    }\r\n  }\r\n};\r\n\r\n\r\n/*\r\n  * Search for a template ID, and return its parent element.\r\n  * Example:\r\n  *   <templateId root=\"2.16.840.1.113883.10.20.22.2.17\"/>\r\n  * Can be found using:\r\n  *   el = dom.template('2.16.840.1.113883.10.20.22.2.17');\r\n  */\r\nvar template = function (templateId) {\r\n  var el = tagAttrVal(this.el, 'templateId', 'root', templateId);\r\n  if (!el) {\r\n    return emptyEl();\r\n  } else {\r\n    return wrapElement(el.parentNode);\r\n  }\r\n};\r\n\r\n/*\r\n  * Search for a content tag by \"ID\", and return it as an element.\r\n  * These are used in the unstructured versions of each section but\r\n  * referenced from the structured version sometimes.\r\n  * Example:\r\n  *   <content ID=\"UniqueNameReferencedElsewhere\"/>\r\n  * Can be found using:\r\n  *   el = dom.content('UniqueNameReferencedElsewhere');\r\n  *\r\n  * We can't use `getElementById` because `ID` (the standard attribute name\r\n  * in this context) is not the same attribute as `id` in XML, so there are no matches\r\n  */\r\nvar content = function (contentId) {\r\n    var el = tagAttrVal(this.el, 'content', 'ID', contentId);\r\n    if (!el) {\r\n      // check the <td> tag too, which isn't really correct but\r\n      // will inevitably be used sometimes because it looks like very\r\n      // normal HTML to put the data directly in a <td>\r\n      el = tagAttrVal(this.el, 'td', 'ID', contentId);\r\n    }\r\n    if (!el) {\r\n      // Ugh, Epic uses really non-standard locations.\r\n      el = tagAttrVal(this.el, 'caption', 'ID', contentId) ||\r\n            tagAttrVal(this.el, 'paragraph', 'ID', contentId) ||\r\n            tagAttrVal(this.el, 'tr', 'ID', contentId) ||\r\n            tagAttrVal(this.el, 'item', 'ID', contentId);\r\n    }\r\n\r\n    if (!el) {\r\n      return emptyEl();\r\n    } else {\r\n      return wrapElement(el);\r\n    }\r\n  };\r\n\r\n\r\n/*\r\n  * Search for the first occurrence of an element by tag name.\r\n  */\r\nvar tag = function (tag) {\r\n  var el = this.el.getElementsByTagName(tag)[0];\r\n  if (!el) {\r\n    return emptyEl();\r\n  } else {\r\n    return wrapElement(el);\r\n  }\r\n};\r\n\r\n/*\r\n  * Like `tag`, except it will only count a tag that is an immediate child of `this`.\r\n  * This is useful for tags like \"text\" which A. may not be present for a given location\r\n  * in every document and B. have a very different meaning depending on their positioning\r\n  *\r\n  *   <parent>\r\n  *     <target></target>\r\n  *   </parent>\r\n  * vs.\r\n  *   <parent>\r\n  *     <intermediate>\r\n  *       <target></target>\r\n  *     </intermediate>\r\n  *   </parent>\r\n  * parent.immediateChildTag('target') will have a result in the first case but not in the second.\r\n  */\r\nvar immediateChildTag = function (tag) {\r\n  var els = this.el.getElementsByTagName(tag);\r\n  if (!els) { return null; }\r\n  for (var i = 0; i < els.length; i++) {\r\n    if (els[i].parentNode === this.el) {\r\n      return wrapElement(els[i]);\r\n    }\r\n  }\r\n  return emptyEl();\r\n};\r\n\r\n\r\n/*\r\n  * Search for all elements by tag name.\r\n  */\r\nvar elsByTag = function (tag) {\r\n  return wrapElement(this.el.getElementsByTagName(tag));\r\n};\r\n\r\n\r\nvar unescapeSpecialChars = function(s) {\r\n  if (!s) { return s; }\r\n  return s.replace(/&lt;/g, '<')\r\n          .replace(/&gt;/g, '>')\r\n          .replace(/&amp;/g, '&')\r\n          .replace(/&quot;/g, '\"')\r\n          .replace(/&apos;/g, \"'\");\r\n};\r\n\r\n\r\n/*\r\n  * Retrieve the element's attribute value. Example:\r\n  *   value = el.attr('displayName');\r\n  *\r\n  * The browser and jsdom return \"null\" for empty attributes;\r\n  * xmldom (which we now use because it's faster / can be explicitly\r\n  * told to parse malformed XML as XML anyways), return the empty\r\n  * string instead, so we fix that here.\r\n  */\r\nvar attr = function (attrName) {\r\n  if (!this.el) { return null; }\r\n  var attrVal = this.el.getAttribute(attrName);\r\n  if (attrVal) {\r\n    return unescapeSpecialChars(attrVal);\r\n  }\r\n  return null;\r\n};\r\n\r\n/*\r\n  * Wrapper for attr() for retrieving boolean attributes;\r\n  * a raw call attr() will return Strings, which can be unexpected,\r\n  * since the string 'false' will by truthy\r\n  */\r\nvar boolAttr = function (attrName) {\r\n  var rawAttr = this.attr(attrName);\r\n  if (rawAttr === 'true' || rawAttr === '1') {\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n\r\n/*\r\n  * Retrieve the element's value. For example, if the element is:\r\n  *   <city>Madison</city>\r\n  * Use:\r\n  *   value = el.tag('city').val();\r\n  *\r\n  * This function also knows how to retrieve the value of <reference> tags,\r\n  * which can store their content in a <content> tag in a totally different\r\n  * part of the document.\r\n  */\r\nvar val = function (html) {\r\n  if (!this.el) { return null; }\r\n  if (!this.el.childNodes || !this.el.childNodes.length) { return null; }\r\n  \r\n  var textContent;\r\n  if (html) {\r\n    textContent = this.el.innerHTML;\r\n    if (!textContent && root.XMLSerializer)\r\n      textContent = new XMLSerializer().serializeToString(this.el);\r\n  } else {\r\n    textContent = this.el.textContent;\r\n  }\r\n\r\n  // if there's no text value here and the only thing inside is a\r\n  // <reference> tag, see if there's a linked <content> tag we can\r\n  // get something out of\r\n  if (!stripWhitespace(textContent)) {\r\n\r\n    var contentId;\r\n    // \"no text value\" might mean there's just a reference tag\r\n    if (this.el.childNodes.length === 1 &&\r\n        this.el.childNodes[0].tagName === 'reference') {\r\n      contentId = this.el.childNodes[0].getAttribute('value');\r\n\r\n    // or maybe a newlines on top/above the reference tag\r\n    } else if (this.el.childNodes.length === 3 &&\r\n        this.el.childNodes[1].tagName === 'reference') {\r\n      contentId = this.el.childNodes[1].getAttribute('value');\r\n\r\n    } else {\r\n      return unescapeSpecialChars(textContent);\r\n    }\r\n\r\n    if (contentId && contentId[0] === '#') {\r\n      contentId = contentId.slice(1); // get rid of the '#'\r\n      var docRoot = wrapElement(this.el.ownerDocument);\r\n      var contentTag = docRoot.content(contentId);\r\n      return contentTag.val();\r\n    }\r\n  }\r\n\r\n  return unescapeSpecialChars(textContent);\r\n};\r\n\r\n\r\n/*\r\n  * Creates and returns an empty DOM element with tag name \"empty\":\r\n  *   <empty></empty>\r\n  */\r\nvar emptyEl = function () {\r\n  var el = doc.createElement('empty');\r\n  return wrapElement(el);\r\n};\r\n\r\n\r\n/*\r\n  * Determines if the element is empty, i.e.:\r\n  *   <empty></empty>\r\n  * This element is created by function `emptyEL`.\r\n  */\r\nvar isEmpty = function () {\r\n  if (this.el.tagName.toLowerCase() === 'empty') {\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n};\r\n\r\n\r\n/*\r\n  * Cross-browser XML parsing supporting IE8+ and Node.js.\r\n  */\r\nfunction parse(data) {\r\n  // XML data must be a string\r\n  if (!data || typeof data !== \"string\") {\r\n    console.log(\"BB Error: XML data is not a string\");\r\n    return null;\r\n  }\r\n  \r\n  var xml, parser;\r\n  \r\n  // Node\r\n  if (isNode) {\r\n    parser = new (xmldom.DOMParser)();\r\n    xml = parser.parseFromString(data, \"text/xml\");\r\n    \r\n  // Browser\r\n  } else {\r\n    \r\n    // Standard parser\r\n    if (window.DOMParser) {\r\n      parser = new DOMParser();\r\n      xml = parser.parseFromString(data, \"text/xml\");\r\n      \r\n    // IE\r\n    } else {\r\n      try {\r\n        xml = new ActiveXObject(\"Microsoft.XMLDOM\");\r\n        xml.async = \"false\";\r\n        xml.loadXML(data);\r\n      } catch (e) {\r\n        console.log(\"BB ActiveX Exception: Could not parse XML\");\r\n      }\r\n    }\r\n  }\r\n  \r\n  if (!xml || !xml.documentElement || xml.getElementsByTagName(\"parsererror\").length) {\r\n    console.log(\"BB Error: Could not parse XML\");\r\n    return null;\r\n  }\r\n  \r\n  return wrapElement(xml);\r\n};\r\n\r\n\r\n// Establish the root object, `window` in the browser, or `global` in Node.\r\nvar root = window || global,\r\n    xmldom,\r\n    isNode = false,\r\n    doc = root.document; // Will be `undefined` if we're in Node\r\n\r\n// Check if we're in Node. If so, pull in `xmldom` so we can simulate the DOM.\r\nif (typeof process === 'object' && Object.prototype.toString.call(process) === '[object process]') {\r\n  isNode = true;\r\n  xmldom = require(\"xmldom\");\r\n  doc = new xmldom.DOMImplementation().createDocument();\r\n}\r\n\r\nmodule.exports = {\r\n  parse: parse\r\n};","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","module.exports = require(\"xmldom\");","/*\r\n  * ...\r\n  */\r\nvar C32 = require('./documents/c32');\r\nvar CCD = require('./documents/ccd');\r\nvar CCDA = require('./documents/ccda');\r\nvar CCDAR2 = require('./documents/ccdar2');\r\n\r\nmodule.exports = function() {\r\n  var self = this;\r\n\r\n  self.detect = detect;\r\n  self.entries = entries;\r\n  self.parseDate = parseDate;\r\n  self.parseName = parseName;\r\n  self.parseAddress = parseAddress;\r\n  self.C32 = new C32(getEntries);\r\n  self.CCD = new CCD(getEntries);\r\n  self.CCDA = new CCDA(getEntries);\r\n  self.CCDAR2 = new CCDAR2(getEntries);\r\n};\r\n\r\nfunction getEntries() {\r\n  return entries;\r\n};\r\n\r\nfunction detect(data) {\r\n  if (!data.template) {\r\n    return 'json';\r\n  }\r\n  \r\n  if (!data.template('2.16.840.1.113883.3.88.11.32.1').isEmpty()) {\r\n    return 'c32';\r\n  } else if(!data.template('2.16.840.1.113883.10.20.22.1.1').isEmpty()) {\r\n    return 'ccda';\r\n  } else if(!data.template('2.16.840.1.113883.10.20.22.1.15').isEmpty()) {\r\n    return 'ccdar2';\r\n  }else if(!data.template('2.16.840.1.113883.10.20.22.1.2').isEmpty()) {\r\n    return 'ccd';\r\n  }\r\n};\r\n\r\n\r\n/*\r\n  * Get entries within an element (with tag name 'entry'), adds an `each` function\r\n  */\r\nfunction entries() {\r\n  var each = function (callback) {\r\n    for (var i = 0; i < this.length; i++) {\r\n      callback(this[i]);\r\n    }\r\n  };\r\n  \r\n  var els = this.elsByTag('entry');\r\n  els.each = each;\r\n  return els;\r\n};\r\n\r\n\r\n/*\r\n  * Parses an HL7 date in String form and creates a new Date object.\r\n  * \r\n  * TODO: CCDA dates can be in form:\r\n  *   <effectiveTime value=\"20130703094812\"/>\r\n  * ...or:\r\n  *   <effectiveTime>\r\n  *     <low value=\"19630617120000\"/>\r\n  *     <high value=\"20110207100000\"/>\r\n  *   </effectiveTime>\r\n  * For the latter, parseDate will not be given type `String`\r\n  * and will return `null`.\r\n  */\r\nfunction parseDate(str) {\r\n  if (!str || typeof str !== 'string') {\r\n    return null;\r\n  }\r\n\r\n  // Note: months start at 0 (so January is month 0)\r\n\r\n  // e.g., value=\"1999\" translates to Jan 1, 1999\r\n  if (str.length === 4) {\r\n    return new Date(str, 0, 1);\r\n  }\r\n\r\n  var year = str.substr(0, 4);\r\n  // subtract 1 from the month since they're zero-indexed\r\n  var month = parseInt(str.substr(4, 2), 10) - 1;\r\n  // days are not zero-indexed. If we end up with the day 0 or '',\r\n  // that will be equivalent to the last day of the previous month\r\n  var day = str.substr(6, 2) || 1;\r\n\r\n  // check for time info (the presence of at least hours and mins after the date)\r\n  if (str.length >= 12) {\r\n    var hour = str.substr(8, 2);\r\n    var min = str.substr(10, 2);\r\n    var secs = str.substr(12, 2);\r\n\r\n    // check for timezone info (the presence of chars after the seconds place)\r\n    if (str.length > 14) {\r\n      // _utcOffsetFromString will return 0 if there's no utc offset found.\r\n      var utcOffset = _utcOffsetFromString(str.substr(14));\r\n      // We subtract that offset from the local time to get back to UTC\r\n      // (e.g., if we're -480 mins behind UTC, we add 480 mins to get back to UTC)\r\n      min = _toInt(min) - utcOffset;\r\n    }\r\n\r\n    var date = new Date(Date.UTC(year, month, day, hour, min, secs));\r\n    // This flag lets us output datetime-precision in our JSON even if the time happens\r\n    // to translate to midnight local time. If we clone the date object, it is not\r\n    // guaranteed to survive.\r\n    date._parsedWithTimeData = true;\r\n    return date;\r\n  }\r\n\r\n  return new Date(year, month, day);\r\n};\r\n\r\n// These regexes and the two functions below are copied from moment.js\r\n// http://momentjs.com/\r\n// https://github.com/moment/moment/blob/develop/LICENSE\r\nvar parseTimezoneChunker = /([\\+\\-]|\\d\\d)/gi;\r\nvar parseTokenTimezone = /Z|[\\+\\-]\\d\\d:?\\d\\d/gi; // +00:00 -00:00 +0000 -0000 or Z\r\nfunction _utcOffsetFromString(string) {\r\n    string = string || '';\r\n    var possibleTzMatches = (string.match(parseTokenTimezone) || []),\r\n        tzChunk = possibleTzMatches[possibleTzMatches.length - 1] || [],\r\n        parts = (tzChunk + '').match(parseTimezoneChunker) || ['-', 0, 0],\r\n        minutes = +(parts[1] * 60) + _toInt(parts[2]);\r\n\r\n    return parts[0] === '+' ? minutes : -minutes;\r\n}\r\nfunction _toInt(argumentForCoercion) {\r\n    var coercedNumber = +argumentForCoercion,\r\n        value = 0;\r\n\r\n    if (coercedNumber !== 0 && isFinite(coercedNumber)) {\r\n        if (coercedNumber >= 0) {\r\n            value = Math.floor(coercedNumber);\r\n        } else {\r\n            value = Math.ceil(coercedNumber);\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n\r\n/*\r\n  * Parses an HL7 name (prefix / given [] / family)\r\n  */\r\nfunction parseName(nameEl) {\r\n  var prefix = nameEl.tag('prefix').val();\r\n  \r\n  var els = nameEl.elsByTag('given');\r\n  var given = [];\r\n  for (var i = 0; i < els.length; i++) {\r\n    var val = els[i].val();\r\n    if (val) { given.push(val); }\r\n  }\r\n  \r\n  var family = nameEl.tag('family').val();\r\n  \r\n  return {\r\n    prefix: prefix,\r\n    given: given,\r\n    family: family\r\n  };\r\n};\r\n\r\n\r\n/*\r\n  * Parses an HL7 address (streetAddressLine [], city, state, postalCode, country)\r\n  */\r\nfunction parseAddress(addrEl) {\r\n  var els = addrEl.elsByTag('streetAddressLine');\r\n  var street = [];\r\n  \r\n  for (var i = 0; i < els.length; i++) {\r\n    var val = els[i].val();\r\n    if (val) { street.push(val); }\r\n  }\r\n  \r\n  var city = addrEl.tag('city').val(),\r\n      state = addrEl.tag('state').val(),\r\n      zip = addrEl.tag('postalCode').val(),\r\n      country = addrEl.tag('country').val();\r\n  \r\n  return {\r\n    street: street,\r\n    city: city,\r\n    state: state,\r\n    zip: zip,\r\n    country: country\r\n  };\r\n};\r\n","/*\r\n * ...\r\n */\r\n \r\nmodule.exports = function(getEntries) {\r\n  var self = this;\r\n\r\n  self.getEntries = getEntries;\r\n  self.process = process;\r\n  self.section = section;\r\n\r\n  /*\r\n  * Preprocesses the C32 document\r\n  */\r\n  function process(c32) {\r\n    c32.section = section;\r\n    return c32;\r\n  };\r\n\r\n  /*\r\n    * Finds the section of a C32 document\r\n    *\r\n    * Usually we check first for the HITSP section ID and then for the HL7-CCD ID.\r\n    */\r\n  function section(name) {\r\n    var el, entries = self.getEntries();\r\n    \r\n    switch (name) {\r\n      case 'document':\r\n        return this.template('2.16.840.1.113883.3.88.11.32.1');\r\n      case 'allergies':\r\n        el = this.template('2.16.840.1.113883.3.88.11.83.102');\r\n        if (el.isEmpty()) {\r\n          el = this.template('2.16.840.1.113883.10.20.1.2');\r\n        }\r\n        el.entries = entries;\r\n        return el;\r\n      case 'demographics':\r\n        return this.template('2.16.840.1.113883.3.88.11.32.1');\r\n      case 'encounters':\r\n        el = this.template('2.16.840.1.113883.3.88.11.83.127');\r\n        if (el.isEmpty()) {\r\n          el = this.template('2.16.840.1.113883.10.20.1.3');\r\n        }\r\n        el.entries = entries;\r\n        return el;\r\n      case 'immunizations':\r\n        el = this.template('2.16.840.1.113883.3.88.11.83.117');\r\n        if (el.isEmpty()) {\r\n          el = this.template('2.16.840.1.113883.10.20.1.6');\r\n        }\r\n        el.entries = entries;\r\n        return el;\r\n      case 'results':\r\n        el = this.template('2.16.840.1.113883.3.88.11.83.122');\r\n        if (el.isEmpty()) {\r\n          el = this.template('2.16.840.1.113883.10.20.1.14');\r\n        }\r\n        el.entries = entries;\r\n        return el;\r\n      case 'medications':\r\n        el = this.template('2.16.840.1.113883.3.88.11.83.112');\r\n        if (el.isEmpty()) {\r\n          el = this.template('2.16.840.1.113883.10.20.1.8');\r\n        }\r\n        el.entries = entries;\r\n        return el;\r\n      case 'problems':\r\n        el = this.template('2.16.840.1.113883.3.88.11.83.103');\r\n        if (el.isEmpty()) {\r\n          el = this.template('2.16.840.1.113883.10.20.1.11');\r\n        }\r\n        el.entries = entries;\r\n        return el;\r\n      case 'procedures':\r\n        el = this.template('2.16.840.1.113883.3.88.11.83.108');\r\n        if (el.isEmpty()) {\r\n          el = this.template('2.16.840.1.113883.10.20.1.12');\r\n        }\r\n        el.entries = entries;\r\n        return el;\r\n      case 'vitals':\r\n        el = this.template('2.16.840.1.113883.3.88.11.83.119');\r\n        if (el.isEmpty()) {\r\n          el = this.template('2.16.840.1.113883.10.20.1.16');\r\n        }\r\n        el.entries = entries;\r\n        return el;\r\n    }\r\n    \r\n    return null;\r\n  };\r\n};\r\n","/*\r\n * ...\r\n */\r\n\r\nmodule.exports = function (getEntries) {\r\n    var self = this;\r\n    self.getEntries = getEntries;\r\n\r\n    self.process = process;\r\n    self.section = section;\r\n\r\n    /*\r\n     * Preprocesses the CCDAR2 document\r\n     */\r\n    function process(ccda) {\r\n        ccda.section = section;\r\n        return ccda;\r\n    };\r\n\r\n    /*\r\n     * Finds the section of a CCDA document\r\n     */\r\n    function section(name) {\r\n        var el, entries = self.getEntries();\r\n\r\n        switch (name) {\r\n            case 'document':\r\n                return this.template('2.16.840.1.113883.10.20.22.1.2');\r\n            case 'demographics':\r\n                return this.template('2.16.840.1.113883.10.20.22.1.2');\r\n            case 'health_concerns_document':\r\n                el = this.template('2.16.840.1.113883.10.20.22.2.58');\r\n                el.entries = entries;\r\n                return el;\r\n            case 'goals':\r\n                el = this.template('2.16.840.1.113883.10.20.22.2.60');\r\n                el.entries = entries;\r\n                return el;\r\n            case 'interventions':\r\n                el = this.template('2.16.840.1.113883.10.20.21.2.3');\r\n                el.entries = entries;\r\n                return el;\r\n            case 'health_status_outcomes':\r\n                el = this.template('2.16.840.1.113883.10.20.22.2.61');\r\n                el.entries = entries;\r\n                return el;\r\n        }\r\n\r\n        return null;\r\n    };\r\n}\r\n","/*\r\n * ...\r\n */\r\n\r\nmodule.exports = function (getEntries) {\r\n  var self = this;\r\n\r\n  self.getEntries = getEntries;\r\n  self.process = process;\r\n  self.section = section;\r\n  \r\n  /*\r\n   * Preprocesses the CCDA document\r\n   */\r\n  function process(ccda) {\r\n    ccda.section = section;\r\n    return ccda;\r\n  };  \r\n  \r\n  /*\r\n   * Finds the section of a CCDA document\r\n   */\r\n  function section(name) {\r\n    var el, entries = self.getEntries();\r\n    \r\n    switch (name) {\r\n      case 'document':\r\n        return this.template('2.16.840.1.113883.10.20.22.1.1');\r\n      case 'allergies':\r\n        el = this.template('2.16.840.1.113883.10.20.22.2.6.1');\r\n        el.entries = entries;\r\n        return el;\r\n      case 'care_plan':\r\n        el = this.template('2.16.840.1.113883.10.20.22.2.10');\r\n        el.entries = entries;\r\n        return el;\r\n      case 'chief_complaint':\r\n        el = this.template('2.16.840.1.113883.10.20.22.2.13');\r\n        if (el.isEmpty()) {\r\n          el = this.template('1.3.6.1.4.1.19376.1.5.3.1.1.13.2.1');\r\n        }\r\n        // no entries in Chief Complaint\r\n        return el;\r\n      case 'demographics':\r\n        return this.template('2.16.840.1.113883.10.20.22.1.1');\r\n      case 'encounters':\r\n        el = this.template('2.16.840.1.113883.10.20.22.2.22');\r\n        if (el.isEmpty()) {\r\n          el = this.template('2.16.840.1.113883.10.20.22.2.22.1');\r\n        }\r\n        el.entries = entries;\r\n        return el;\r\n      case 'functional_statuses':\r\n        el = this.template('2.16.840.1.113883.10.20.22.2.14');\r\n        el.entries = entries;\r\n        return el;\r\n      case 'immunizations':\r\n        el = this.template('2.16.840.1.113883.10.20.22.2.2.1');\r\n        if (el.isEmpty()) {\r\n          el = this.template('2.16.840.1.113883.10.20.22.2.2');\r\n        }\r\n        el.entries = entries;\r\n        return el;\r\n      case 'instructions':\r\n        el = this.template('2.16.840.1.113883.10.20.22.2.45');\r\n        el.entries = entries;\r\n        return el;\r\n      case 'results':\r\n        el = this.template('2.16.840.1.113883.10.20.22.2.3.1');\r\n        if (el.isEmpty()) {\r\n          el = this.template('2.16.840.1.113883.10.20.22.2.3');\r\n        }\r\n        el.entries = entries;\r\n        return el;\r\n      case 'medications':\r\n        el = this.template('2.16.840.1.113883.10.20.22.2.1.1');\r\n        if (el.isEmpty()) {\r\n          el = this.template('2.16.840.1.113883.10.20.22.2.1');\r\n        }\r\n        el.entries = entries;\r\n        return el;\r\n      case 'problems':\r\n        el = this.template('2.16.840.1.113883.10.20.22.2.5.1');\r\n        if (el.isEmpty()) {\r\n          el = this.template('2.16.840.1.113883.10.20.22.2.5');\r\n        }\r\n        el.entries = entries;\r\n        return el;\r\n      case 'procedures':\r\n        el = this.template('2.16.840.1.113883.10.20.22.2.7.1');\r\n        if (el.isEmpty()) {\r\n          el = this.template('2.16.840.1.113883.10.20.22.2.7');\r\n        }\r\n        el.entries = entries;\r\n        return el;\r\n      case 'social_history':\r\n        el = this.template('2.16.840.1.113883.10.20.22.2.17');\r\n        el.entries = entries;\r\n        return el;\r\n      case 'vitals':\r\n        el = this.template('2.16.840.1.113883.10.20.22.2.4.1');\r\n        if (el.isEmpty()) {\r\n          el = this.template('2.16.840.1.113883.10.20.22.2.4');\r\n        }\r\n        el.entries = entries;\r\n        return el;\r\n    }\r\n    \r\n    return null;\r\n  };  \r\n};\r\n","/*\r\n * ...\r\n */\r\n\r\nmodule.exports = function (getEntries) {\r\n    var self = this;\r\n    self.getEntries = getEntries;\r\n    \r\n    self.process = process;\r\n    self.section = section;   \r\n\r\n    /*\r\n     * Preprocesses the CCDAR2 document\r\n     */\r\n    function process(ccda) {\r\n        ccda.section = section;\r\n        return ccda;\r\n    };\r\n\r\n    /*\r\n     * Finds the section of a CCDA document\r\n     */\r\n    function section(name) {\r\n        var el, entries = self.getEntries();\r\n\r\n        switch (name) {\r\n            case 'document':\r\n                return this.template('2.16.840.1.113883.10.20.22.1.15');\r\n            case 'demographics':\r\n                return this.template('2.16.840.1.113883.10.20.22.1.15');\r\n            case 'health_concerns_document':\r\n                el = this.template('2.16.840.1.113883.10.20.22.2.58');\r\n                el.entries = entries;\r\n                return el;\r\n            case 'goals':\r\n                el = this.template('2.16.840.1.113883.10.20.22.2.60');\r\n                el.entries = entries;\r\n                return el;\r\n            case 'interventions':\r\n                el = this.template('2.16.840.1.113883.10.20.21.2.3');\r\n                el.entries = entries;\r\n                return el;\r\n            case 'health_status_outcomes':\r\n                el = this.template('2.16.840.1.113883.10.20.22.2.61');\r\n                el.entries = entries;\r\n                return el;\r\n        }\r\n\r\n        return null;\r\n    };\r\n}\r\n","/*\r\n * ...\r\n */\r\n\r\nvar C32 = require('./generators/c32');\r\nvar CCDA = require('./generators/ccda');\r\n\r\nvar method = function () {};\r\n\r\n/* exported Generators */\r\nmodule.exports = {\r\n  method: method,\r\n  C32: C32,\r\n  CCDA: CCDA\r\n};\r\n  \r\n\r\n\r\n  /* Import ejs if we're in Node. Then setup custom formatting filters\r\n   */\r\n  /*if (typeof exports !== 'undefined') {\r\n    if (typeof module !== 'undefined' && module.exports) {\r\n      ejs = require(\"ejs\");\r\n    }\r\n  }\r\n\r\n  if (typeof ejs !== 'undefined') {\r\n    /* Filters are automatically available to ejs to be used like \"... | hl7Date\"\r\n     * Helpers are functions that we'll manually pass in to ejs.\r\n     * The intended distinction is that a helper gets called with regular function-call syntax\r\n     */ /*\r\n    var pad = function(number) {\r\n      if (number < 10) {\r\n        return '0' + number;\r\n      }\r\n      return String(number);\r\n    };\r\n\r\n    ejs.filters.hl7Date = function(obj) {\r\n      try {\r\n          if (obj === null || obj === undefined) { return 'nullFlavor=\"UNK\"'; }\r\n          var date = new Date(obj);\r\n          if (isNaN(date.getTime())) { return obj; }\r\n\r\n          var dateStr = null;\r\n          if (date.getHours() || date.getMinutes() || date.getSeconds()) {\r\n            // If there's a meaningful time, output a UTC datetime\r\n            dateStr = date.getUTCFullYear() +\r\n              pad( date.getUTCMonth() + 1 ) +\r\n              pad( date.getUTCDate() );\r\n            var timeStr = pad( date.getUTCHours() ) +\r\n              pad( date.getUTCMinutes() ) +\r\n              pad ( date.getUTCSeconds() ) +\r\n              \"+0000\";\r\n            return 'value=\"' + dateStr + timeStr + '\"';\r\n           \r\n          } else {\r\n            // If there's no time, don't apply timezone tranformations: just output a date\r\n            dateStr = String(date.getFullYear()) +\r\n              pad( date.getMonth() + 1 ) +\r\n              pad( date.getDate() );\r\n            return 'value=\"' + dateStr + '\"';\r\n          }\r\n\r\n      } catch (e) {\r\n          return obj;\r\n      }\r\n    };\r\n\r\n    var escapeSpecialChars = function(s) {\r\n      return s.replace(/</g, '&lt;')\r\n              .replace(/>/g, '&gt;')\r\n              .replace(/&/g, '&amp;')\r\n              .replace(/\"/g, '&quot;')\r\n              .replace(/'/g, '&apos;');\r\n    };\r\n\r\n    ejs.filters.hl7Code = function(obj) {\r\n      if (!obj) { return ''; }\r\n\r\n      var tag = '';\r\n      var name = obj.name || '';\r\n      if (obj.name) { tag += 'displayName=\"'+escapeSpecialChars(name)+'\"'; }\r\n\r\n      if (obj.code) {\r\n        tag += ' code=\"'+obj.code+'\"';\r\n        if (obj.code_system) { tag += ' codeSystem=\"'+escapeSpecialChars(obj.code_system)+'\"'; }\r\n        if (obj.code_system_name) { tag += ' codeSystemName=\"' +\r\n                                        escapeSpecialChars(obj.code_system_name)+'\"'; }\r\n      } else {\r\n        tag += ' nullFlavor=\"UNK\"';\r\n      }\r\n\r\n      if (!obj.name && ! obj.code) {\r\n        return 'nullFlavor=\"UNK\"';\r\n      }\r\n      \r\n      return tag;\r\n    };\r\n\r\n    ejs.filters.emptyStringIfFalsy = function(obj) {\r\n      if (!obj) { return ''; }\r\n      return obj;\r\n    };\r\n\r\n    if (!ejs.helpers) ejs.helpers = {};\r\n    ejs.helpers.simpleTag = function(tagName, value) {\r\n      if (value) {\r\n        return \"<\"+tagName+\">\"+value+\"</\"+tagName+\">\";\r\n      } else {\r\n        return \"<\"+tagName+\" nullFlavor=\\\"UNK\\\" />\";\r\n      }\r\n    };\r\n\r\n    ejs.helpers.addressTags = function(addressDict) {\r\n      if (!addressDict) {\r\n        return '<streetAddressLine nullFlavor=\"NI\" />\\n' +\r\n                '<city nullFlavor=\"NI\" />\\n' +\r\n                '<state nullFlavor=\"NI\" />\\n' +\r\n                '<postalCode nullFlavor=\"NI\" />\\n' +\r\n                '<country nullFlavor=\"NI\" />\\n';\r\n      }\r\n      \r\n      var tags = '';\r\n      if (!addressDict.street.length) {\r\n        tags += ejs.helpers.simpleTag('streetAddressLine', null) + '\\n';\r\n      } else {\r\n        for (var i=0; i<addressDict.street.length; i++) {\r\n          tags += ejs.helpers.simpleTag('streetAddressLine', addressDict.street[i]) + '\\n';\r\n        }\r\n      }\r\n      tags += ejs.helpers.simpleTag('city', addressDict.city) + '\\n';\r\n      tags += ejs.helpers.simpleTag('state', addressDict.state) + '\\n';\r\n      tags += ejs.helpers.simpleTag('postalCode', addressDict.zip) + '\\n';\r\n      tags += ejs.helpers.simpleTag('country', addressDict.country) + '\\n';\r\n      return tags;\r\n    };\r\n\r\n    ejs.helpers.nameTags = function(nameDict) {\r\n      if (!nameDict) {\r\n        return '<given nullFlavor=\"NI\" />\\n' +\r\n                '<family nullFlavor=\"NI\" />\\n';\r\n      }\r\n\r\n      var tags = '';\r\n      if (nameDict.prefix) {\r\n        tags += ejs.helpers.simpleTag('prefix', nameDict.prefix) + '\\n';\r\n      }\r\n      if (!nameDict.given.length) {\r\n        tags += ejs.helpers.simpleTag('given', null) + '\\n';\r\n      } else {\r\n        for (var i=0; i<nameDict.given.length; i++) {\r\n          tags += ejs.helpers.simpleTag('given', nameDict.given[i]) + '\\n';\r\n        }\r\n      }\r\n      tags += ejs.helpers.simpleTag('family', nameDict.family) + '\\n';\r\n      if (nameDict.suffix) {\r\n        tags += ejs.helpers.simpleTag('suffix', nameDict.suffix) + '\\n';\r\n      }\r\n      return tags;\r\n    };\r\n\r\n  }*/\r\n","/*\r\n * ...\r\n */\r\n\r\nmodule.exports = {\r\n  run: run\r\n};\r\n  \r\n/*\r\n  * Generates a C32 document\r\n  */\r\nfunction run(json, template, testingMode) {\r\n  /* jshint unused: false */ // only until this stub is actually implemented\r\n  console.log(\"C32 generation is not implemented yet\");\r\n  return null;\r\n};","/*\r\n * ...\r\n */\r\nvar _ = require('lodash');\r\n\r\nmodule.exports = {\r\n  run: run\r\n};\r\n  \r\n/*\r\n  * Generates a CCDA document\r\n  * A lot of the EJS setup happens in generators.js\r\n  *\r\n  * If `testingMode` is true, we'll set the \"now\" variable to a specific,\r\n  * fixed time, so that the expected XML doesn't change across runs\r\n  */\r\nfunction run(json, template, testingMode) {\r\n  if (!template) {\r\n    console.log(\"Please provide a template EJS file for the Generator to use. \" +\r\n                \"Load it via fs.readFileSync in Node or XHR in the browser.\");\r\n    return null;\r\n  }\r\n\r\n  // `now` is actually now, unless we're running this for a test,\r\n  // in which case it's always Jan 1, 2000 at 12PM UTC\r\n  var now = (testingMode) ?\r\n    new Date('2000-01-01T12:00:00Z') : new Date();\r\n\r\n  var ccda = _.template(template, {\r\n    filename: 'ccda.xml',\r\n    bb: json,\r\n    now: now,\r\n    tagHelpers: ejs.helpers,\r\n    codes: Core.Codes\r\n  });\r\n  return ccda;\r\n};","module.exports = require(\"lodash\");","/*\r\n * ...\r\n */\r\nvar C32 = require('./parsers/c32');\r\nvar CCD = require('./parsers/ccd');\r\nvar CCDA = require('./parsers/ccda');\r\nvar CCDAR2 = require('./parsers/ccdar2');\r\n\r\nvar method = function () {};\r\n\r\n/* exported Parsers */\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n  self.method = method;\r\n  self.C32 = new C32(self.doc);\r\n  self.CCD = new CCD(self.doc);\r\n  self.CCDA = new CCDA(self.doc);\r\n  self.CCDAR2 = new CCDAR2(self.doc);\r\n}; ","/*\r\n * Parser for the C32 document\r\n */\r\n\r\nvar Core = require('../core');\r\nvar AllergiesParser = require('./c32/allergies');\r\nvar DemographicsParser = require('./c32/demographics');\r\nvar DocumentParser = require('./c32/document');\r\nvar EncountersParser = require('./c32/encounters');\r\nvar ImmunizationsParser = require('./c32/immunizations');\r\nvar MedicationsParser = require('./c32/medications');\r\nvar ProblemsParser = require('./c32/problems');\r\nvar ProceduresParser = require('./c32/procedures');\r\nvar ResultsParser = require('./c32/results');\r\nvar VitalsParser = require('./c32/vitals');\r\nvar ParseGenericInfo = require('./generic');\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n\r\n  self.doc = doc;\r\n  self.allergiesParser = new AllergiesParser(self.doc);\r\n  self.demographicsParser = new DemographicsParser(self.doc);\r\n  self.demographicsParser = new DocumentParser(self.doc);\r\n  self.encountersParser = new EncountersParser(self.doc);\r\n  self.immunizationsParser = new ImmunizationsParser(self.doc);\r\n  self.medicationsParser = new MedicationsParser(self.doc);\r\n  self.problemsParser = new ProblemsParser(self.doc);\r\n  self.proceduresParser = new ProceduresParser(self.doc);\r\n  self.resultsParser = new ResultsParser(self.doc);\r\n  self.vitalsParser = new VitalsParser(self.doc);\r\n\r\n  self.run = function (c32) {\r\n    var data = {};\r\n    \r\n    data.document              = self.demographicsParser.parse(c32);\r\n    data.allergies             = self.allergiesParser.parse(c32);\r\n    data.demographics          = self.demographicsParser.parse(c32);\r\n    data.encounters            = self.encountersParser.parse(c32);\r\n    var parsedImmunizations    = self.immunizationsParser.parse(c32);\r\n    data.immunizations         = parsedImmunizations.administered;\r\n    data.immunization_declines = parsedImmunizations.declined;\r\n    data.results               = self.resultsParser.parse(c32);\r\n    data.medications           = self.medicationsParser.parse(c32);\r\n    data.problems              = self.problemsParser.parse(c32);\r\n    data.procedures            = self.proceduresParser.parse(c32);\r\n    data.vitals                = self.vitals.parse(c32);\r\n    \r\n    data.json                       = Core.json;\r\n    data.document.json              = Core.json;\r\n    data.allergies.json             = Core.json;\r\n    data.demographics.json          = Core.json;\r\n    data.encounters.json            = Core.json;\r\n    data.immunizations.json         = Core.json;\r\n    data.immunization_declines.json = Core.json;\r\n    data.results.json               = Core.json;\r\n    data.medications.json           = Core.json;\r\n    data.problems.json              = Core.json;\r\n    data.procedures.json            = Core.json;\r\n    data.vitals.json                = Core.json;\r\n  \r\n    // Sections that are in CCDA but not C32... we want to keep the API\r\n    // consistent, even if the entries are always null\r\n    data.smoking_status = {\r\n      date: null,\r\n      name: null,\r\n      code: null,\r\n      code_system: null,\r\n      code_system_name: null\r\n    };\r\n    data.smoking_status.json = Core.json;\r\n    \r\n    data.chief_complaint = {\r\n      text: null\r\n    };\r\n    data.chief_complaint.json = Core.json;\r\n  \r\n    data.care_plan = [];\r\n    data.care_plan.json = Core.json;\r\n  \r\n    data.instructions = [];\r\n    data.instructions.json = Core.json;\r\n  \r\n    data.functional_statuses = [];\r\n    data.functional_statuses.json = Core.json;\r\n  \r\n    // Decorate each section with Title, templateId and text and adds missing sections\r\n    ParseGenericInfo(c32, data);\r\n  \r\n    return data;\r\n  };\r\n};\r\n\r\n\r\n","/*\r\n * Parser for the C32 allergies section\r\n */\r\n\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n  self.parse = parse;\r\n\r\n  function parse(c32) {\r\n  \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var allergies = c32.section('allergies');\r\n\r\n    var data = {}, el;\r\n    data.entries = [];\r\n    data.displayName = \"Allergies\";\r\n    data.templateId = allergies.tag('templateId').attr('root');\r\n    data.text = allergies.tag('text').val(true);\r\n\r\n    allergies.entries().each(function(entry) {\r\n      \r\n      el = entry.tag('effectiveTime');\r\n      var start_date = parseDate(el.tag('low').attr('value')),\r\n          end_date = parseDate(el.tag('high').attr('value'));\r\n      \r\n      el = entry.template('2.16.840.1.113883.3.88.11.83.6').tag('code');\r\n      var name = el.attr('displayName'),\r\n          code = el.attr('code'),\r\n          code_system = el.attr('codeSystem'),\r\n          code_system_name = el.attr('codeSystemName');\r\n      \r\n      // value => reaction_type\r\n      el = entry.template('2.16.840.1.113883.3.88.11.83.6').tag('value');\r\n      var reaction_type_name = el.attr('displayName'),\r\n          reaction_type_code = el.attr('code'),\r\n          reaction_type_code_system = el.attr('codeSystem'),\r\n          reaction_type_code_system_name = el.attr('codeSystemName');\r\n      \r\n      // reaction\r\n      el = entry.template('2.16.840.1.113883.10.20.1.54').tag('value');\r\n      var reaction_name = el.attr('displayName'),\r\n          reaction_code = el.attr('code'),\r\n          reaction_code_system = el.attr('codeSystem');\r\n      \r\n      // an irregularity seen in some c32s\r\n      if (!reaction_name) {\r\n        el = entry.template('2.16.840.1.113883.10.20.1.54').tag('text');\r\n        if (!el.isEmpty()) {\r\n          reaction_name = Core.stripWhitespace(el.val());\r\n        }\r\n      }\r\n\r\n      // severity\r\n      el = entry.template('2.16.840.1.113883.10.20.1.55').tag('value');\r\n      var severity = el.attr('displayName');\r\n      \r\n      // participant => allergen\r\n      el = entry.tag('participant').tag('code');\r\n      var allergen_name = el.attr('displayName'),\r\n          allergen_code = el.attr('code'),\r\n          allergen_code_system = el.attr('codeSystem'),\r\n          allergen_code_system_name = el.attr('codeSystemName');\r\n\r\n      // another irregularity seen in some c32s\r\n      if (!allergen_name) {\r\n        el = entry.tag('participant').tag('name');\r\n        if (!el.isEmpty()) {\r\n          allergen_name = el.val();\r\n        }\r\n      }\r\n      if (!allergen_name) {\r\n        el = entry.template('2.16.840.1.113883.3.88.11.83.6').tag('originalText');\r\n        if (!el.isEmpty()) {\r\n          allergen_name = Core.stripWhitespace(el.val());\r\n        }\r\n      }\r\n      \r\n      // status\r\n      el = entry.template('2.16.840.1.113883.10.20.1.39').tag('value');\r\n      var status = el.attr('displayName');\r\n      \r\n      data.entries.push({\r\n        date_range: {\r\n          start: start_date,\r\n          end: end_date\r\n        },\r\n        name: name,\r\n        code: code,\r\n        code_system: code_system,\r\n        code_system_name: code_system_name,\r\n        status: status,\r\n        severity: severity,\r\n        reaction: {\r\n          name: reaction_name,\r\n          code: reaction_code,\r\n          code_system: reaction_code_system\r\n        },\r\n        reaction_type: {\r\n          name: reaction_type_name,\r\n          code: reaction_type_code,\r\n          code_system: reaction_type_code_system,\r\n          code_system_name: reaction_type_code_system_name\r\n        },\r\n        allergen: {\r\n          name: allergen_name,\r\n          code: allergen_code,\r\n          code_system: allergen_code_system,\r\n          code_system_name: allergen_code_system_name\r\n        }\r\n      });\r\n    });  \r\n    return data;\r\n  }\r\n};\r\n","/*\r\n * Parser for the C32 demographics section\r\n */\r\n\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n  self.parse = parse;\r\n\r\n  function parse(c32) {    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var data = {}, el;\r\n    \r\n    var demographics = c32.section('demographics');\r\n    \r\n    var patient = demographics.tag('patientRole');\r\n    el = patient.tag('patient').tag('name');\r\n    var patient_name_dict = parseName(el);\r\n    \r\n    el = patient.tag('patient');\r\n    var dob = parseDate(el.tag('birthTime').attr('value')),\r\n        gender = Core.Codes.gender(el.tag('administrativeGenderCode').attr('code')),\r\n        marital_status = Core.Codes.maritalStatus(el.tag('maritalStatusCode').attr('code'));\r\n    \r\n    el = patient.tag('addr');\r\n    var patient_address_dict = parseAddress(el);\r\n    \r\n    el = patient.tag('telecom');\r\n    var home = el.attr('value'),\r\n        work = null,\r\n        mobile = null;\r\n    \r\n    var email = null;\r\n    \r\n    var language = patient.tag('languageCommunication').tag('languageCode').attr('code'),\r\n        race = patient.tag('raceCode').attr('displayName'),\r\n        ethnicity = patient.tag('ethnicGroupCode').attr('displayName'),\r\n        religion = patient.tag('religiousAffiliationCode').attr('displayName');\r\n    \r\n    el = patient.tag('birthplace');\r\n    var birthplace_dict = parseAddress(el);\r\n    \r\n    el = patient.tag('guardian');\r\n    var guardian_relationship = el.tag('code').attr('displayName'),\r\n      guardian_relationship_code = el.tag('code').attr('code'),\r\n        guardian_home = el.tag('telecom').attr('value');\r\n    \r\n    el = el.tag('guardianPerson').tag('name');\r\n    var guardian_name_dict = parseName(el);\r\n    \r\n    el = patient.tag('guardian').tag('addr');\r\n    var guardian_address_dict = parseAddress(el);\r\n    \r\n    el = patient.tag('providerOrganization');\r\n    var provider_organization = el.tag('name').val(),\r\n        provider_phone = el.tag('telecom').attr('value'),\r\n        provider_address_dict = parseAddress(el.tag('addr'));\r\n    \r\n    data = {\r\n      name: patient_name_dict,\r\n      dob: dob,\r\n      gender: gender,\r\n      marital_status: marital_status,\r\n      address: patient_address_dict,\r\n      phone: {\r\n        home: home,\r\n        work: work,\r\n        mobile: mobile\r\n      },\r\n      email: email,\r\n      language: language,\r\n      race: race,\r\n      ethnicity: ethnicity,\r\n      religion: religion,\r\n      birthplace: {\r\n        state: birthplace_dict.state,\r\n        zip: birthplace_dict.zip,\r\n        country: birthplace_dict.country\r\n      },\r\n      guardian: {\r\n        name: {\r\n          given: guardian_name_dict.given,\r\n          family: guardian_name_dict.family\r\n        },\r\n        relationship: guardian_relationship,\r\n        relationship_code: guardian_relationship_code,\r\n        address: guardian_address_dict,\r\n        phone: {\r\n          home: guardian_home\r\n        }\r\n      },\r\n      provider: {\r\n        organization: provider_organization,\r\n        phone: provider_phone,\r\n        address: provider_address_dict\r\n      }\r\n    };\r\n    \r\n    return data;\r\n  };\r\n}\r\n","/*\r\n * Parser for the C32 document section\r\n */\r\n\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n  self.parse = parse;\r\n\r\n  function parse(c32) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var data = {}, el;\r\n    \r\n    var doc = c32.section('document');\r\n  \r\n    // Parse Doc Type Info\r\n    var templates =  doc.elsByTag('templateId');\r\n    var rootTemplate = templates[0].attr('root');\r\n    var secondTemplate;\r\n    if(templates.length >1)\r\n      secondTemplate = templates[1].attr('root');\r\n    else\r\n      secondTemplate = rootTemplate;\r\n  \r\n    var loinc = doc.tag('code').attr('code');\r\n    var templateId = doc.tag('templateId').attr('root');\r\n    var displayName = doc.tag('code').attr('displayName');\r\n  \r\n    var nonXml = doc.tag('nonXMLBody');\r\n    var nonXmlNodes = nonXml.el.childNodes;\r\n  \r\n    var bodyType = \"structured\";\r\n    var nonXmlBody = {\r\n      type: \"\",\r\n      mediaType: \"\",\r\n      representation: \"\",\r\n      rawText: \"\",\r\n      reference: \"\"\r\n    };\r\n  \r\n    if(nonXmlNodes && nonXmlNodes.length > 0) {\r\n      bodyType = \"unstructured\";\r\n      var text = nonXml.tag('text');\r\n      var mediaType = \"\";\r\n      var representation = \"\";\r\n      var rawText = \"\";\r\n      var reference = \"\";\r\n      var type = \"\";\r\n  \r\n      // We have an embedded doc\r\n      if(text && text.attr('mediaType')) {\r\n        mediaType = text.attr('mediaType');\r\n        representation = text.attr('representation');\r\n        rawText = text.val();\r\n        type = \"embedded\";\r\n      }\r\n  \r\n      if(text && !mediaType) {\r\n        reference = text.tag('reference').attr('value');\r\n        type = \"reference\";\r\n      }\r\n      nonXmlBody = {\r\n        type: type,\r\n        mediaType: mediaType,\r\n        representation: representation,\r\n        rawText: rawText,\r\n        reference: reference\r\n      }\r\n    }\r\n  \r\n    var docType = {\r\n      type: \"CCDAR2\",\r\n      rootTemplateId: rootTemplate,\r\n      templateId: secondTemplate,\r\n      displayName: displayName,\r\n      loinc: loinc,\r\n      bodyType: bodyType,\r\n      nonXmlBody: nonXmlBody\r\n    };\r\n    \r\n    var date = parseDate(doc.tag('effectiveTime').attr('value'));\r\n    var title = Core.stripWhitespace(doc.tag('title').val());\r\n    \r\n    var author = doc.tag('author');\r\n    el = author.tag('assignedPerson').tag('name');\r\n    var name_dict = parseName(el);\r\n    // Sometimes C32s include names that are just like <name>String</name>\r\n    // and we still want to get something out in that case\r\n    if (!name_dict.prefix && !name_dict.given.length && !name_dict.family) {\r\n     name_dict.family = el.val();\r\n    }\r\n    \r\n    el = author.tag('addr');\r\n    var address_dict = parseAddress(el);\r\n    \r\n    el = author.tag('telecom');\r\n    var work_phone = el.attr('value');\r\n  \r\n    var documentation_of_list = [];\r\n    var performers = doc.tag('documentationOf').elsByTag('performer');\r\n    for (var i = 0; i < performers.length; i++) {\r\n      el = performers[i].tag('assignedPerson').tag('name');\r\n      var performer_name_dict = parseName(el);\r\n      var performer_phone = performers[i].tag('telecom').attr('value');\r\n      var performer_addr = parseAddress(el.tag('addr'));\r\n      documentation_of_list.push({\r\n        name: performer_name_dict,\r\n        phone: {\r\n          work: performer_phone\r\n        },\r\n        address: performer_addr\r\n      });\r\n    }\r\n  \r\n    el = doc.tag('encompassingEncounter');\r\n    var location_name = Core.stripWhitespace(el.tag('name').val());\r\n    var location_addr_dict = parseAddress(el.tag('addr'));\r\n    \r\n    var encounter_date = null;\r\n    el = el.tag('effectiveTime');\r\n    if (!el.isEmpty()) {\r\n      encounter_date = parseDate(el.attr('value'));\r\n    }\r\n    \r\n    data = {\r\n      type: docType,\r\n      date: date,\r\n      title: title,\r\n      author: {\r\n        name: name_dict,\r\n        address: address_dict,\r\n        phone: {\r\n          work: work_phone\r\n        }\r\n      },\r\n      documentation_of: documentation_of_list,\r\n      location: {\r\n        name: location_name,\r\n        address: location_addr_dict,\r\n        encounter_date: encounter_date\r\n      }\r\n    };\r\n    \r\n    return data;\r\n  };\r\n}","/*\r\n * Parser for the C32 encounters section\r\n */\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n  self.parse = parse;\r\n\r\n  function parse(c32) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var encounters = c32.section('encounters');\r\n  \r\n    var data = {}, el;\r\n    data.entries = [];\r\n    data.displayName = \"Encounters\";\r\n    data.templateId = encounters.tag('templateId').attr('root');\r\n    data.text = encounters.tag('text').val(true);\r\n  \r\n    encounters.entries().each(function(entry) {\r\n      \r\n      var date = parseDate(entry.tag('effectiveTime').attr('value'));\r\n      if (!date) {\r\n        date = parseDate(entry.tag('effectiveTime').tag('low').attr('value'));\r\n      }\r\n      \r\n      el = entry.tag('code');\r\n      var name = el.attr('displayName'),\r\n          code = el.attr('code'),\r\n          code_system = el.attr('codeSystem'),\r\n          code_system_name = el.attr('codeSystemName'),\r\n          code_system_version = el.attr('codeSystemVersion');\r\n      \r\n      // translation\r\n      el = entry.tag('translation');\r\n      var translation_name = el.attr('displayName'),\r\n          translation_code = el.attr('code'),\r\n          translation_code_system = el.attr('codeSystem'),\r\n          translation_code_system_name = el.attr('codeSystemName');\r\n      \r\n      // performer\r\n      el = entry.tag('performer');\r\n      var performer_name = el.tag('name').val(),\r\n          performer_code = el.attr('code'),\r\n          performer_code_system = el.attr('codeSystem'),\r\n          performer_code_system_name = el.attr('codeSystemName');\r\n      \r\n      // participant => location\r\n      el = entry.tag('participant');\r\n      var organization = el.tag('name').val(),\r\n          location_dict = parseAddress(el);\r\n      location_dict.organization = organization;\r\n  \r\n      // findings\r\n      var findings = [];\r\n      var findingEls = entry.elsByTag('entryRelationship');\r\n      for (var i = 0; i < findingEls.length; i++) {\r\n        el = findingEls[i].tag('value');\r\n        findings.push({\r\n          name: el.attr('displayName'),\r\n          code: el.attr('code'),\r\n          code_system: el.attr('codeSystem')\r\n        });\r\n      }\r\n      \r\n      data.entries.push({\r\n        date: date,\r\n        name: name,\r\n        code: code,\r\n        code_system: code_system,\r\n        code_system_name: code_system_name,\r\n        code_system_version: code_system_version,\r\n        findings: findings,\r\n        translation: {\r\n          name: translation_name,\r\n          code: translation_code,\r\n          code_system: translation_code_system,\r\n          code_system_name: translation_code_system_name\r\n        },\r\n        performer: {\r\n          name: performer_name,\r\n          code: performer_code,\r\n          code_system: performer_code_system,\r\n          code_system_name: performer_code_system_name\r\n        },\r\n        location: location_dict\r\n      });\r\n    });\r\n    \r\n    return data;\r\n  };\r\n}\r\n","/*\r\n * Parser for the C32 immunizations section\r\n */\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n  self.parse = parse;\r\n\r\n  function parse(c32) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var administeredData = {}, declinedData = {}, product, el;\r\n  \r\n    var immunizations = c32.section('immunizations');\r\n  \r\n    administeredData.entries = [];\r\n    administeredData.displayName = \"Immunizations\";\r\n    administeredData.templateId = immunizations.tag('templateId').attr('root');\r\n    administeredData.text = immunizations.tag('text').val(true);\r\n  \r\n    declinedData.entries = [];\r\n    declinedData.displayName = \"Immunizations Declined\";\r\n    declinedData.templateId = immunizations.tag('templateId').attr('root');\r\n    declinedData.text = immunizations.tag('text').val(true);\r\n  \r\n  \r\n    \r\n    immunizations.entries().each(function(entry) {\r\n      \r\n      // date\r\n      el = entry.tag('effectiveTime');\r\n      var date = parseDate(el.attr('value'));\r\n      if (!date) {\r\n        date = parseDate(el.tag('low').attr('value'));\r\n      }\r\n  \r\n      // if 'declined' is true, this is a record that this vaccine WASN'T administered\r\n      el = entry.tag('substanceAdministration');\r\n      var declined = el.boolAttr('negationInd');\r\n  \r\n      // product\r\n      product = entry.template('2.16.840.1.113883.10.20.1.53');\r\n      el = product.tag('code');\r\n      var product_name = el.attr('displayName'),\r\n          product_code = el.attr('code'),\r\n          product_code_system = el.attr('codeSystem'),\r\n          product_code_system_name = el.attr('codeSystemName');\r\n  \r\n      // translation\r\n      el = product.tag('translation');\r\n      var translation_name = el.attr('displayName'),\r\n          translation_code = el.attr('code'),\r\n          translation_code_system = el.attr('codeSystem'),\r\n          translation_code_system_name = el.attr('codeSystemName');\r\n  \r\n      // misc product details\r\n      el = product.tag('lotNumberText');\r\n      var lot_number = el.val();\r\n  \r\n      el = product.tag('manufacturerOrganization');\r\n      var manufacturer_name = el.tag('name').val();\r\n      \r\n      // route\r\n      el = entry.tag('routeCode');\r\n      var route_name = el.attr('displayName'),\r\n          route_code = el.attr('code'),\r\n          route_code_system = el.attr('codeSystem'),\r\n          route_code_system_name = el.attr('codeSystemName');\r\n      \r\n      // instructions\r\n      el = entry.template('2.16.840.1.113883.10.20.1.49');\r\n      var instructions_text = Core.stripWhitespace(el.tag('text').val());\r\n      el = el.tag('code');\r\n      var education_name = el.attr('displayName'),\r\n          education_code = el.attr('code'),\r\n          education_code_system = el.attr('codeSystem');\r\n  \r\n      // dose\r\n      el = entry.tag('doseQuantity');\r\n      var dose_value = el.attr('value'),\r\n          dose_unit = el.attr('unit');\r\n      \r\n      var data = (declined) ? declinedData : administeredData;\r\n      data.entries.push({\r\n        date: date,\r\n        product: {\r\n          name: product_name,\r\n          code: product_code,\r\n          code_system: product_code_system,\r\n          code_system_name: product_code_system_name,\r\n          translation: {\r\n            name: translation_name,\r\n            code: translation_code,\r\n            code_system: translation_code_system,\r\n            code_system_name: translation_code_system_name\r\n          },\r\n          lot_number: lot_number,\r\n          manufacturer_name: manufacturer_name\r\n        },\r\n        dose_quantity: {\r\n          value: dose_value,\r\n          unit: dose_unit\r\n        },\r\n        route: {\r\n          name: route_name,\r\n          code: route_code,\r\n          code_system: route_code_system,\r\n          code_system_name: route_code_system_name\r\n        },\r\n        instructions: instructions_text,\r\n        education_type: {\r\n          name: education_name,\r\n          code: education_code,\r\n          code_system: education_code_system\r\n        }\r\n      });\r\n    });\r\n    \r\n    return {\r\n      administered: administeredData,\r\n      declined: declinedData\r\n    };\r\n  };\r\n}\r\n","var Core = require('../../core');\r\n\r\n/*\r\n * Parser for the C32 medications section\r\n */\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n  self.parse = parse;\r\n  \r\n  function parse(c32) {    \r\n    var parseDate = self.doc.parseDate;\r\n    var medications = c32.section('medications');\r\n  \r\n    var data = {}, el;\r\n    data.entries = [];\r\n    data.displayName = \"Medications\";\r\n    data.templateId = medications.tag('templateId').attr('root');\r\n    data.text = medications.tag('text').val(true);\r\n    \r\n    medications.entries().each(function(entry) {\r\n  \r\n      var text = null;\r\n      el = entry.tag('substanceAdministration').immediateChildTag('text');\r\n      if (!el.isEmpty()) {\r\n        // technically C32s don't use this, but C83s (another CCD) do,\r\n        // and CCDAs do, so we may see it anyways\r\n        text = Core.stripWhitespace(el.val());\r\n      }\r\n  \r\n      var effectiveTimes = entry.elsByTag('effectiveTime');\r\n  \r\n      el = effectiveTimes[0]; // the first effectiveTime is the med start date\r\n      var start_date = null, end_date = null;\r\n      if (el) {\r\n        start_date = parseDate(el.tag('low').attr('value'));\r\n        end_date = parseDate(el.tag('high').attr('value'));\r\n      }\r\n  \r\n      // the second effectiveTime might the schedule period or it might just\r\n      // be a random effectiveTime from further in the entry... xsi:type should tell us\r\n      el = effectiveTimes[1];\r\n      var schedule_type = null, schedule_period_value = null, schedule_period_unit = null;\r\n      if (el && el.attr('xsi:type') === 'PIVL_TS') {\r\n        var institutionSpecified = el.attr('institutionSpecified');\r\n        if (institutionSpecified === 'true') {\r\n          schedule_type= 'frequency';\r\n        } else if (institutionSpecified === 'false') {\r\n          schedule_type = 'interval';\r\n        }\r\n  \r\n        el = el.tag('period');\r\n        schedule_period_value = el.attr('value');\r\n        schedule_period_unit = el.attr('unit');\r\n      }\r\n      \r\n      el = entry.tag('manufacturedProduct').tag('code');\r\n      var product_name = el.attr('displayName'),\r\n          product_code = el.attr('code'),\r\n          product_code_system = el.attr('codeSystem');\r\n  \r\n      var product_original_text = null;\r\n      el = entry.tag('manufacturedProduct').tag('originalText');\r\n      if (!el.isEmpty()) {\r\n        product_original_text = Core.stripWhitespace(el.val());\r\n      }\r\n      // if we don't have a product name yet, try the originalText version\r\n      if (!product_name && product_original_text) {\r\n        product_name = product_original_text;\r\n      }\r\n  \r\n      // irregularity in some c32s\r\n      if (!product_name) {\r\n        el = entry.tag('manufacturedProduct').tag('name');\r\n        if (!el.isEmpty()) {\r\n          product_name = Core.stripWhitespace(el.val());\r\n        }\r\n      }\r\n      \r\n      el = entry.tag('manufacturedProduct').tag('translation');\r\n      var translation_name = el.attr('displayName'),\r\n          translation_code = el.attr('code'),\r\n          translation_code_system = el.attr('codeSystem'),\r\n          translation_code_system_name = el.attr('codeSystemName');\r\n      \r\n      el = entry.tag('doseQuantity');\r\n      var dose_value = el.attr('value'),\r\n          dose_unit = el.attr('unit');\r\n      \r\n      el = entry.tag('rateQuantity');\r\n      var rate_quantity_value = el.attr('value'),\r\n          rate_quantity_unit = el.attr('unit');\r\n      \r\n      el = entry.tag('precondition').tag('value');\r\n      var precondition_name = el.attr('displayName'),\r\n          precondition_code = el.attr('code'),\r\n          precondition_code_system = el.attr('codeSystem');\r\n      \r\n      el = entry.template('2.16.840.1.113883.10.20.1.28').tag('value');\r\n      var reason_name = el.attr('displayName'),\r\n          reason_code = el.attr('code'),\r\n          reason_code_system = el.attr('codeSystem');\r\n      \r\n      el = entry.tag('routeCode');\r\n      var route_name = el.attr('displayName'),\r\n          route_code = el.attr('code'),\r\n          route_code_system = el.attr('codeSystem'),\r\n          route_code_system_name = el.attr('codeSystemName');\r\n      \r\n      // participant/playingEntity => vehicle\r\n      el = entry.tag('participant').tag('playingEntity');\r\n      var vehicle_name = el.tag('name').val();\r\n  \r\n      el = el.tag('code');\r\n      // prefer the code vehicle_name but fall back to the non-coded one\r\n      // (which for C32s is in fact the primary field for this info)\r\n      vehicle_name = el.attr('displayName') || vehicle_name;\r\n      var vehicle_code = el.attr('code'),\r\n          vehicle_code_system = el.attr('codeSystem'),\r\n          vehicle_code_system_name = el.attr('codeSystemName');\r\n      \r\n      el = entry.tag('administrationUnitCode');\r\n      var administration_name = el.attr('displayName'),\r\n          administration_code = el.attr('code'),\r\n          administration_code_system = el.attr('codeSystem'),\r\n          administration_code_system_name = el.attr('codeSystemName');\r\n      \r\n      // performer => prescriber\r\n      el = entry.tag('performer');\r\n      var prescriber_organization = el.tag('name').val(),\r\n          prescriber_person = null;\r\n      \r\n      data.entries.push({\r\n        date_range: {\r\n          start: start_date,\r\n          end: end_date\r\n        },\r\n        text: text,\r\n        product: {\r\n          name: product_name,\r\n          text: product_original_text,\r\n          code: product_code,\r\n          code_system: product_code_system,\r\n          translation: {\r\n            name: translation_name,\r\n            code: translation_code,\r\n            code_system: translation_code_system,\r\n            code_system_name: translation_code_system_name\r\n          }\r\n        },\r\n        dose_quantity: {\r\n          value: dose_value,\r\n          unit: dose_unit\r\n        },\r\n        rate_quantity: {\r\n          value: rate_quantity_value,\r\n          unit: rate_quantity_unit\r\n        },\r\n        precondition: {\r\n          name: precondition_name,\r\n          code: precondition_code,\r\n          code_system: precondition_code_system\r\n        },\r\n        reason: {\r\n          name: reason_name,\r\n          code: reason_code,\r\n          code_system: reason_code_system\r\n        },\r\n        route: {\r\n          name: route_name,\r\n          code: route_code,\r\n          code_system: route_code_system,\r\n          code_system_name: route_code_system_name\r\n        },\r\n        schedule: {\r\n          type: schedule_type,\r\n          period_value: schedule_period_value,\r\n          period_unit: schedule_period_unit\r\n        },\r\n        vehicle: {\r\n          name: vehicle_name,\r\n          code: vehicle_code,\r\n          code_system: vehicle_code_system,\r\n          code_system_name: vehicle_code_system_name\r\n        },\r\n        administration: {\r\n          name: administration_name,\r\n          code: administration_code,\r\n          code_system: administration_code_system,\r\n          code_system_name: administration_code_system_name\r\n        },\r\n        prescriber: {\r\n          organization: prescriber_organization,\r\n          person: prescriber_person\r\n        }\r\n      });\r\n    });\r\n    \r\n    return data;\r\n  };\r\n}\r\n","var Core = require('../../core');\r\n\r\n/*\r\n * Parser for the C32 problems section\r\n */\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n  self.parse = parse;\r\n\r\n  function parse(c32) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var problems = c32.section('problems');\r\n  \r\n    var data = {}, el;\r\n    data.entries = [];\r\n    data.displayName = \"Problems\";\r\n    data.templateId = problems.tag('templateId').attr('root');\r\n    data.text = problems.tag('text').val(true);\r\n  \r\n    problems.entries().each(function(entry) {\r\n      \r\n      el = entry.tag('effectiveTime');\r\n      var start_date = parseDate(el.tag('low').attr('value')),\r\n          end_date = parseDate(el.tag('high').attr('value'));\r\n      \r\n      el = entry.template('2.16.840.1.113883.10.20.1.28').tag('value');\r\n      var name = el.attr('displayName'),\r\n          code = el.attr('code'),\r\n          code_system = el.attr('codeSystem'),\r\n          code_system_name = el.attr('codeSystemName');\r\n  \r\n      // Pre-C32 CCDs put the problem name in this \"originalText\" field, and some vendors\r\n      // continue doing this with their C32, even though it's not technically correct\r\n      if (!name) {\r\n        el = entry.template('2.16.840.1.113883.10.20.1.28').tag('originalText');\r\n        if (!el.isEmpty()) {\r\n          name = Core.stripWhitespace(el.val());\r\n        }\r\n      }\r\n  \r\n      el = entry.template('2.16.840.1.113883.10.20.1.28').tag('translation');\r\n      var translation_name = el.attr('displayName'),\r\n          translation_code = el.attr('code'),\r\n          translation_code_system = el.attr('codeSystem'),\r\n          translation_code_system_name = el.attr('codeSystemName');\r\n      \r\n      el = entry.template('2.16.840.1.113883.10.20.1.50');\r\n      var status = el.tag('value').attr('displayName');\r\n      \r\n      var age = null;\r\n      el = entry.template('2.16.840.1.113883.10.20.1.38');\r\n      if (!el.isEmpty()) {\r\n        age = parseFloat(el.tag('value').attr('value'));\r\n      }\r\n      \r\n      data.entries.push({\r\n        date_range: {\r\n          start: start_date,\r\n          end: end_date\r\n        },\r\n        name: name,\r\n        status: status,\r\n        age: age,\r\n        code: code,\r\n        code_system: code_system,\r\n        code_system_name: code_system_name,\r\n        translation: {\r\n          name: translation_name,\r\n          code: translation_code,\r\n          code_system: translation_code_system,\r\n          code_system_name: translation_code_system_name\r\n        },\r\n        comment: null // not part of C32\r\n      });\r\n    });\r\n    \r\n    return data;\r\n  };\r\n}\r\n","/*\r\n * Parser for the C32 procedures section\r\n */\r\n\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n  self.parse = parse;\r\n\r\n  function parse(c32) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var procedures = c32.section('procedures');\r\n  \r\n    var data = {}, el;\r\n    data.entries = [];\r\n    data.displayName = \"Procedures\";\r\n    data.templateId = procedures.tag('templateId').attr('root');\r\n    data.text = procedures.tag('text').val(true);\r\n    \r\n    procedures.entries().each(function(entry) {\r\n      \r\n      el = entry.tag('effectiveTime');\r\n      var date = parseDate(el.attr('value'));\r\n      \r\n      el = entry.tag('code');\r\n      var name = el.attr('displayName'),\r\n          code = el.attr('code'),\r\n          code_system = el.attr('codeSystem');\r\n  \r\n      if (!name) {\r\n        name = Core.stripWhitespace(entry.tag('originalText').val());\r\n      }\r\n      \r\n      // 'specimen' tag not always present\r\n      el = entry.tag('specimen').tag('code');\r\n      var specimen_name = el.attr('displayName'),\r\n          specimen_code = el.attr('code'),\r\n          specimen_code_system = el.attr('codeSystem');\r\n      \r\n      el = entry.tag('performer').tag('addr');\r\n      var organization = el.tag('name').val(),\r\n          phone = el.tag('telecom').attr('value');\r\n      \r\n      var performer_dict = parseAddress(el);\r\n      performer_dict.organization = organization;\r\n      performer_dict.phone = phone;\r\n      \r\n      // participant => device\r\n      el = entry.tag('participant').tag('code');\r\n      var device_name = el.attr('displayName'),\r\n          device_code = el.attr('code'),\r\n          device_code_system = el.attr('codeSystem');\r\n      \r\n      data.entries.push({\r\n        date: date,\r\n        name: name,\r\n        code: code,\r\n        code_system: code_system,\r\n        specimen: {\r\n          name: specimen_name,\r\n          code: specimen_code,\r\n          code_system: specimen_code_system\r\n        },\r\n        performer: performer_dict,\r\n        device: {\r\n          name: device_name,\r\n          code: device_code,\r\n          code_system: device_code_system\r\n        }\r\n      });\r\n    });\r\n    \r\n    return data;\r\n  };\r\n}","/*\r\n * Parser for the C32 results (labs) section\r\n */\r\n\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n  self.parse = parse;\r\n\r\n  function parse(c32) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var results = c32.section('results');\r\n  \r\n    var data = {}, el;\r\n    data.entries = [];\r\n    data.displayName = \"Results\";\r\n    data.templateId = results.tag('templateId').attr('root');\r\n    data.text = results.tag('text').val(true);\r\n  \r\n  \r\n    results.entries().each(function(entry) {\r\n      \r\n      el = entry.tag('effectiveTime');\r\n      var panel_date = parseDate(entry.tag('effectiveTime').attr('value'));\r\n      if (!panel_date) {\r\n        panel_date = parseDate(entry.tag('effectiveTime').tag('low').attr('value'));\r\n      }\r\n      \r\n      // panel\r\n      el = entry.tag('code');\r\n      var panel_name = el.attr('displayName'),\r\n          panel_code = el.attr('code'),\r\n          panel_code_system = el.attr('codeSystem'),\r\n          panel_code_system_name = el.attr('codeSystemName');\r\n      \r\n      var observation;\r\n      var tests = entry.elsByTag('observation');\r\n      var tests_data = [];\r\n      \r\n      for (var i = 0; i < tests.length; i++) {\r\n        observation = tests[i];\r\n        \r\n        // sometimes results organizers contain non-results. we only want tests\r\n        if (observation.template('2.16.840.1.113883.10.20.1.31').val()) {\r\n          var date = parseDate(observation.tag('effectiveTime').attr('value'));\r\n          \r\n          el = observation.tag('code');\r\n          var name = el.attr('displayName'),\r\n              code = el.attr('code'),\r\n              code_system = el.attr('codeSystem'),\r\n              code_system_name = el.attr('codeSystemName');\r\n  \r\n          if (!name) {\r\n            name = Core.stripWhitespace(observation.tag('text').val());\r\n          }\r\n      \r\n          el = observation.tag('translation');\r\n          var translation_name = el.attr('displayName'),\r\n          translation_code = el.attr('code'),\r\n          translation_code_system = el.attr('codeSystem'),\r\n          translation_code_system_name = el.attr('codeSystemName');\r\n      \r\n          el = observation.tag('value');\r\n          var value = el.attr('value'),\r\n              unit = el.attr('unit');\r\n          // We could look for xsi:type=\"PQ\" (physical quantity) but it seems better\r\n          // not to trust that that field has been used correctly...\r\n          if (value && !isNaN(parseFloat(value))) {\r\n            value = parseFloat(value);\r\n          }\r\n          if (!value) {\r\n            value = el.val(); // look for free-text values\r\n          }\r\n      \r\n          el = observation.tag('referenceRange');\r\n          var reference_range_text = Core.stripWhitespace(el.tag('observationRange').tag('text').val()),\r\n              reference_range_low_unit = el.tag('observationRange').tag('low').attr('unit'),\r\n              reference_range_low_value = el.tag('observationRange').tag('low').attr('value'),\r\n              reference_range_high_unit = el.tag('observationRange').tag('high').attr('unit'),\r\n              reference_range_high_value = el.tag('observationRange').tag('high').attr('value');\r\n          \r\n          tests_data.push({\r\n            date: date,\r\n            name: name,\r\n            value: value,\r\n            unit: unit,\r\n            code: code,\r\n            code_system: code_system,\r\n            code_system_name: code_system_name,\r\n            translation: {\r\n              name: translation_name,\r\n              code: translation_code,\r\n              code_system: translation_code_system,\r\n              code_system_name: translation_code_system_name\r\n            },\r\n            reference_range: {\r\n              text: reference_range_text,\r\n              low_unit: reference_range_low_unit,\r\n              low_value: reference_range_low_value,\r\n              high_unit: reference_range_high_unit,\r\n              high_value: reference_range_high_value,\r\n            }\r\n          });\r\n        }\r\n      }\r\n      \r\n      data.entries.push({\r\n        name: panel_name,\r\n        code: panel_code,\r\n        code_system: panel_code_system,\r\n        code_system_name: panel_code_system_name,\r\n        date: panel_date,\r\n        tests: tests_data\r\n      });\r\n    });\r\n    \r\n    return data;\r\n  };  \r\n}","/*\r\n * Parser for the C32 vitals section\r\n */\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n  self.parse = parse;\r\n\r\n  function parse(c32) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var vitals = c32.section('vitals');\r\n  \r\n    var data = {}, el;\r\n    data.entries = [];\r\n    data.displayName = \"Vitals\";\r\n    data.templateId = vitals.tag('templateId').attr('root');\r\n    data.text = vitals.tag('text').val(true);\r\n    \r\n    vitals.entries().each(function(entry) {\r\n      \r\n      el = entry.tag('effectiveTime');\r\n      var entry_date = parseDate(el.attr('value'));\r\n      \r\n      var result;\r\n      var results = entry.elsByTag('component');\r\n      var results_data = [];\r\n      \r\n      for (var j = 0; j < results.length; j++) {\r\n        result = results[j];\r\n        \r\n        // Results\r\n        \r\n        el = result.tag('code');\r\n        var name = el.attr('displayName'),\r\n            code = el.attr('code'),\r\n            code_system = el.attr('codeSystem'),\r\n            code_system_name = el.attr('codeSystemName');\r\n        \r\n        el = result.tag('value');\r\n        var value = parseFloat(el.attr('value')),\r\n            unit = el.attr('unit');\r\n        \r\n        results_data.push({\r\n          name: name,\r\n          code: code,\r\n          code_system: code_system,\r\n          code_system_name: code_system_name,\r\n          value: value,\r\n          unit: unit\r\n        });\r\n      }\r\n      \r\n      data.entries.push({\r\n        date: entry_date,\r\n        results: results_data\r\n      });\r\n    });\r\n    \r\n    return data;\r\n  };\r\n}","/*\r\n * Parser for the CCDAR2 document\r\n */\r\n\r\nvar ParseGenericInfo = require('./generic');\r\nvar Core = require('../core');\r\nvar DocumentParser = require('./ccd/document');\r\nvar DemographicsParser = require('./ccda/demographics');\r\nvar HealthConcernsParser = require('./ccdar2/health_concerns');\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n  self.documentParser = new DocumentParser(self.doc);\r\n  self.demographicsParser = new DemographicsParser(self.doc);\r\n  self.healthConcernsParser = new HealthConcernsParser(self.doc);\r\n  \r\n  self.run = function (ccda) {\r\n    var data = {};\r\n\r\n    data.document              = self.documentParser.document(ccda);\r\n    data.demographics          = self.demographicsParser.demographics(ccda);\r\n    data.health_concerns_document  = self.healthConcernsParser.health_concerns_document(ccda);\r\n    data.json                  = Core.json;\r\n\r\n    // Decorate each section with Title, templateId and text and adds missing sections\r\n    ParseGenericInfo(ccda, data);\r\n\r\n    return data;\r\n  };\r\n}\r\n","/*\r\n * Parser for the CCDAR2 document section\r\n */\r\nvar Core = require('../../core');\r\n\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n  self.document = document;\r\n\r\n  function document(ccda) {\r\n    \r\n      var parseDate = self.doc.parseDate;\r\n      var parseName = self.doc.parseName;\r\n      var parseAddress = self.doc.parseAddress;\r\n      var data = {}, el;\r\n    \r\n      var doc = ccda.section('document');\r\n      var date = parseDate(doc.tag('effectiveTime').attr('value'));\r\n      var title = Core.stripWhitespace(doc.tag('title').val());\r\n    \r\n      // Parse Doc Type Info\r\n      var templates =  doc.elsByTag('templateId');\r\n      \r\n      var rootTemplate = templates[0].attr('root');\r\n      var secondTemplate;\r\n      if(templates.length >1)\r\n        secondTemplate = templates[1].attr('root');\r\n      else\r\n        secondTemplate = rootTemplate;\r\n    \r\n      var loinc = doc.tag('code').attr('code');\r\n      var templateId = doc.tag('templateId').attr('root');\r\n      var displayName = doc.tag('code').attr('displayName');\r\n    \r\n      var nonXml = doc.tag('nonXMLBody');\r\n      var nonXmlNodes = nonXml.el.childNodes;\r\n    \r\n      var bodyType = \"structured\";\r\n      var nonXmlBody = {\r\n        type: \"\",\r\n        mediaType: \"\",\r\n        representation: \"\",\r\n        rawText: \"\",\r\n        reference: \"\"\r\n      };\r\n      if(nonXmlNodes && nonXmlNodes.length > 0) {\r\n        bodyType = \"unstructured\";\r\n        var text = nonXml.tag('text');\r\n        var mediaType = \"\";\r\n        var representation = \"\";\r\n        var rawText = \"\";\r\n        var reference = \"\";\r\n        var type = \"\";\r\n    \r\n        // We have an embedded doc\r\n        if(text && text.attr('mediaType')) {\r\n          mediaType = text.attr('mediaType');\r\n          representation = text.attr('representation');\r\n          rawText = text.val();\r\n          type = \"embedded\";\r\n        }\r\n    \r\n        if(text && !mediaType) {\r\n          reference = text.tag('reference').attr('value');\r\n          type = \"reference\";\r\n        }\r\n        nonXmlBody = {\r\n          type: type,\r\n          mediaType: mediaType,\r\n          representation: representation,\r\n          rawText: rawText,\r\n          reference: reference\r\n        }\r\n      }\r\n    \r\n      var docType = {\r\n        type: \"CCDAR2\",\r\n        rootTemplateId: rootTemplate,\r\n        templateId: secondTemplate,\r\n        displayName: displayName,\r\n        loinc: loinc,\r\n        bodyType: bodyType,\r\n        nonXmlBody: nonXmlBody\r\n      };\r\n    \r\n      var author = doc.tag('author');\r\n      el = author.tag('assignedPerson').tag('name');\r\n      var name_dict = parseName(el);\r\n    \r\n      el = author.tag('addr');\r\n      var address_dict = parseAddress(el);\r\n    \r\n      el = author.tag('telecom');\r\n      var work_phone = el.attr('value');\r\n    \r\n      var documentation_of_list = [];\r\n      var performers = doc.tag('documentationOf').elsByTag('performer');\r\n      for (var i = 0; i < performers.length; i++) {\r\n        el = performers[i];\r\n        var performer_name_dict = parseName(el);\r\n        var performer_phone = el.tag('telecom').attr('value');\r\n        var performer_addr = parseAddress(el.tag('addr'));\r\n        documentation_of_list.push({\r\n          name: performer_name_dict,\r\n          phone: {\r\n            work: performer_phone\r\n          },\r\n          address: performer_addr\r\n        });\r\n      }\r\n    \r\n      el = doc.tag('encompassingEncounter').tag('location');\r\n      var location_name = Core.stripWhitespace(el.tag('name').val());\r\n      var location_addr_dict = parseAddress(el.tag('addr'));\r\n    \r\n      var encounter_date = null;\r\n      el = el.tag('effectiveTime');\r\n      if (!el.isEmpty()) {\r\n        encounter_date = parseDate(el.attr('value'));\r\n      }\r\n    \r\n      data = {\r\n        type: docType,\r\n        date: date,\r\n        title: title,\r\n        author: {\r\n          name: name_dict,\r\n          address: address_dict,\r\n          phone: {\r\n            work: work_phone\r\n          }\r\n        },\r\n        documentation_of: documentation_of_list,\r\n        location: {\r\n          name: location_name,\r\n          address: location_addr_dict,\r\n          encounter_date: encounter_date\r\n        }\r\n      };\r\n    \r\n      return data;\r\n    };\r\n}","var Core = require('../core');\r\nvar AllergiesParser = require('./ccda/allergies');\r\nvar CarePlanParser = require('./ccda/care_plan');\r\nvar DemographicsParser = require('./ccda/demographics');\r\nvar DocumentParser = require('./ccda/document');\r\nvar EncountersParser = require('./ccda/encounters');\r\nvar FreeTextParser = require('./ccda/free_text');\r\nvar FunctionalStatusesParser = require('./ccda/functional_statuses');\r\nvar ImmunizationsParser = require('./ccda/immunizations');\r\nvar InstructionsParser = require('./ccda/instructions');\r\nvar MedicationsParser = require('./ccda/medications');\r\nvar ProblemsParser = require('./ccda/problems');\r\nvar ProceduresParser = require('./ccda/procedures');\r\nvar ResultsParser = require('./ccda/results');\r\nvar SmokingStatusParser = require('./ccda/smoking_status');\r\nvar VitalsParser = require('./ccda/vitals');\r\n\r\nvar ParseGenericInfo = require('./generic');\r\n\r\n/*\r\n * Parser for the CCDA document\r\n */\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n  self.allergiesParser = new AllergiesParser(self.doc);\r\n  self.carePlanParser = new CarePlanParser(self.doc);\r\n  self.demographicsParser = new DemographicsParser(self.doc);\r\n  self.documentParser = new DocumentParser(self.doc);\r\n  self.encountersParser = new EncountersParser(self.doc);\r\n  self.freeTextParser = new FreeTextParser();\r\n  self.functionalStatusesParser = new FunctionalStatusesParser(self.doc);\r\n  self.immunizationsParser = new ImmunizationsParser(self.doc);\r\n  self.instructionsParser = new InstructionsParser();\r\n  self.medicationsParser = new MedicationsParser(self.doc);\r\n  self.problemsParser = new ProblemsParser(self.doc);\r\n  self.proceduresParser = new ProceduresParser(self.doc);\r\n  self.resultsParser = new ResultsParser(self.doc);\r\n  self.smokingStatusParser = new SmokingStatusParser(self.doc);\r\n  self.vitalsParser = new VitalsParser(self.doc);\r\n\r\n\r\n  self.run = function (ccda) {\r\n    var data = {};\r\n    \r\n    data.document              = self.documentParser.document(ccda);\r\n    data.allergies             = self.allergiesParser.allergies(ccda);\r\n    data.care_plan             = self.carePlanParser.care_plan(ccda);\r\n    data.chief_complaint       = self.freeTextParser.free_text(ccda, 'chief_complaint');\r\n    data.demographics          = self.demographicsParser.demographics(ccda);\r\n    data.encounters            = self.encountersParser.encounters(ccda);\r\n    data.functional_statuses   = self.functionalStatusesParser.functional_statuses(ccda);\r\n    var parsedImmunizations    = self.immunizationsParser.immunizations(ccda);\r\n    data.immunizations         = parsedImmunizations.administered;\r\n    data.immunization_declines = parsedImmunizations.declined;\r\n    data.instructions          = self.instructionsParser.instructions(ccda);\r\n    data.results               = self.resultsParser.results(ccda);\r\n    data.medications           = self.medicationsParser.medications(ccda);\r\n    data.problems              = self.problemsParser.problems(ccda);\r\n    data.procedures            = self.proceduresParser.procedures(ccda);\r\n    data.smoking_status        = self.smokingStatusParser.smoking_status(ccda);\r\n    data.vitals                = self.vitalsParser.vitals(ccda);\r\n    \r\n    data.json                        = Core.json;\r\n    data.document.json               = Core.json;\r\n    data.allergies.json              = Core.json;\r\n    data.care_plan.json              = Core.json;\r\n    data.chief_complaint.json        = Core.json;\r\n    data.demographics.json           = Core.json;\r\n    data.encounters.json             = Core.json;\r\n    data.functional_statuses.json    = Core.json;\r\n    data.immunizations.json          = Core.json;\r\n    data.immunization_declines.json  = Core.json;\r\n    data.instructions.json           = Core.json;\r\n    data.results.json                = Core.json;\r\n    data.medications.json            = Core.json;\r\n    data.problems.json               = Core.json;\r\n    data.procedures.json             = Core.json;\r\n    data.smoking_status.json         = Core.json;\r\n    data.vitals.json                 = Core.json;\r\n\r\n    // Decorate each section with Title, templateId and text and adds missing sections\r\n    ParseGenericInfo(ccda, data);\r\n\r\n    return data;\r\n  };\r\n}\r\n","/*\r\n * Parser for the CCDA allergies section\r\n */\r\n\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n  \r\n  self.allergies = function (ccda) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var allergies = ccda.section('allergies');\r\n  \r\n      var data = {}, el;\r\n      data.entries = [];\r\n      data.displayName = \"Allergies\";\r\n      data.templateId = allergies.tag('templateId').attr('root');\r\n      data.text = allergies.tag('text').val(true);\r\n    \r\n    allergies.entries().each(function(entry) {\r\n      \r\n      el = entry.tag('effectiveTime');\r\n      var start_date = parseDate(el.tag('low').attr('value')),\r\n          end_date = parseDate(el.tag('high').attr('value'));\r\n      \r\n      el = entry.template('2.16.840.1.113883.10.20.22.4.7').tag('code');\r\n      var name = el.attr('displayName'),\r\n          code = el.attr('code'),\r\n          code_system = el.attr('codeSystem'),\r\n          code_system_name = el.attr('codeSystemName');\r\n      \r\n      // value => reaction_type\r\n      el = entry.template('2.16.840.1.113883.10.20.22.4.7').tag('value');\r\n      var reaction_type_name = el.attr('displayName'),\r\n          reaction_type_code = el.attr('code'),\r\n          reaction_type_code_system = el.attr('codeSystem'),\r\n          reaction_type_code_system_name = el.attr('codeSystemName');\r\n      \r\n      // reaction\r\n      el = entry.template('2.16.840.1.113883.10.20.22.4.9').tag('value');\r\n      var reaction_name = el.attr('displayName'),\r\n          reaction_code = el.attr('code'),\r\n          reaction_code_system = el.attr('codeSystem');\r\n      \r\n      // severity\r\n      el = entry.template('2.16.840.1.113883.10.20.22.4.8').tag('value');\r\n      var severity = el.attr('displayName');\r\n      \r\n      // participant => allergen\r\n      el = entry.tag('participant').tag('code');\r\n      var allergen_name = el.attr('displayName'),\r\n          allergen_code = el.attr('code'),\r\n          allergen_code_system = el.attr('codeSystem'),\r\n          allergen_code_system_name = el.attr('codeSystemName');\r\n  \r\n      // this is not a valid place to store the allergen name but some vendors use it\r\n      if (!allergen_name) {\r\n        el = entry.tag('participant').tag('name');\r\n        if (!el.isEmpty()) {\r\n          allergen_name = el.val();\r\n        }\r\n      }\r\n      if (!allergen_name) {\r\n        el = entry.template('2.16.840.1.113883.10.20.22.4.7').tag('originalText');\r\n        if (!el.isEmpty()) {\r\n          allergen_name = Core.stripWhitespace(el.val());\r\n        }\r\n      }\r\n      \r\n      // status\r\n      el = entry.template('2.16.840.1.113883.10.20.22.4.28').tag('value');\r\n      var status = el.attr('displayName');\r\n      \r\n      data.entries.push({\r\n        date_range: {\r\n          start: start_date,\r\n          end: end_date\r\n        },\r\n        name: name,\r\n        code: code,\r\n        code_system: code_system,\r\n        code_system_name: code_system_name,\r\n        status: status,\r\n        severity: severity,\r\n        reaction: {\r\n          name: reaction_name,\r\n          code: reaction_code,\r\n          code_system: reaction_code_system\r\n        },\r\n        reaction_type: {\r\n          name: reaction_type_name,\r\n          code: reaction_type_code,\r\n          code_system: reaction_type_code_system,\r\n          code_system_name: reaction_type_code_system_name\r\n        },\r\n        allergen: {\r\n          name: allergen_name,\r\n          code: allergen_code,\r\n          code_system: allergen_code_system,\r\n          code_system_name: allergen_code_system_name\r\n        }\r\n      });\r\n    });\r\n    \r\n    return data;\r\n  };\r\n}","/*\r\n * Parser for the CCDA \"plan of care\" section\r\n */\r\n\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function(doc) {\r\n    var self = this;\r\n    self.doc = doc;\r\n\r\n    self.care_plan = function (ccda) {        \r\n        var data = [], el;\r\n    \r\n        var data = {}, el;\r\n        care_plan = ccda.section('care_plan');\r\n        data.entries = [];\r\n        data.displayName = \"Care Plan\";\r\n        data.templateId = care_plan.tag('templateId').attr('root');\r\n        data.text = care_plan.tag('text').val(true);\r\n    \r\n        care_plan.entries().each(function (entry) {\r\n    \r\n            var name = null,\r\n                code = null,\r\n                code_system = null,\r\n                code_system_name = null;\r\n    \r\n            // Plan of care encounters, which have no other details\r\n            el = entry.template('2.16.840.1.113883.10.20.22.4.40');\r\n            if (!el.isEmpty()) {\r\n                name = 'encounter';\r\n            } else {\r\n                el = entry.tag('code');\r\n    \r\n                name = el.attr('displayName');\r\n                code = el.attr('code');\r\n                code_system = el.attr('codeSystem');\r\n                code_system_name = el.attr('codeSystemName');\r\n            }\r\n    \r\n            var text = Core.stripWhitespace(entry.tag('text').val(true));\r\n            var time = entry.tag('effectiveTime').immediateChildTag('center').attr('value');\r\n    \r\n            data.entries.push({\r\n                text: text,\r\n                name: name,\r\n                code: code,\r\n                code_system: code_system,\r\n                code_system_name: code_system_name,\r\n                effective_time: parse(time)\r\n            });\r\n        });\r\n    \r\n        return data;\r\n    \r\n        function parse(str) {\r\n            if (!str) return null;\r\n            var y = str.substr(0, 4),\r\n                m = str.substr(4, 2) - 1,\r\n                d = str.substr(6, 2);\r\n            var D = new Date(y, m, d);\r\n            return (D.getFullYear() == y && D.getMonth() == m && D.getDate() == d) ? D : null;\r\n        }\r\n    };\r\n}","/*\r\n * Parser for the CCDA document section\r\n */\r\n\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n\r\n  self.document = function (ccda) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var data = {}, el;\r\n    \r\n    var doc = ccda.section('document');\r\n  \r\n  \r\n    // Parse Doc Type Info\r\n    var templates =  doc.elsByTag('templateId');\r\n    var rootTemplate = templates[0].attr('root');\r\n    var secondTemplate;\r\n    if(templates.length >1)\r\n      secondTemplate = templates[1].attr('root');\r\n    else\r\n      secondTemplate = rootTemplate;\r\n  \r\n    var loinc = doc.tag('code').attr('code');\r\n    var templateId = doc.tag('templateId').attr('root');\r\n    var displayName = doc.tag('code').attr('displayName');\r\n  \r\n    var nonXml = doc.tag('nonXMLBody');\r\n    var nonXmlNodes = nonXml.el.childNodes;\r\n  \r\n    var bodyType = \"structured\";\r\n    var nonXmlBody = {\r\n      type: \"\",\r\n      mediaType: \"\",\r\n      representation: \"\",\r\n      rawText: \"\",\r\n      reference: \"\"\r\n    };\r\n    if(nonXmlNodes && nonXmlNodes.length > 0) {\r\n      bodyType = \"unstructured\";\r\n      var text = nonXml.tag('text');\r\n      var mediaType = \"\";\r\n      var representation = \"\";\r\n      var rawText = \"\";\r\n      var reference = \"\";\r\n      var type = \"\";\r\n  \r\n      // We have an embedded doc\r\n      if(text && text.attr('mediaType')) {\r\n        mediaType = text.attr('mediaType');\r\n        representation = text.attr('representation');\r\n        rawText = text.val();\r\n        type = \"embedded\";\r\n      }\r\n  \r\n      if(text && !mediaType) {\r\n         reference = text.tag('reference').attr('value');\r\n        type = \"reference\";\r\n      }\r\n      nonXmlBody = {\r\n        type: type,\r\n        mediaType: mediaType,\r\n        representation: representation,\r\n        rawText: rawText,\r\n        reference: reference\r\n      }\r\n    }\r\n  \r\n    var docType = {\r\n      type: \"CCDAR2\",\r\n      rootTemplateId: rootTemplate,\r\n      templateId: secondTemplate,\r\n      displayName: displayName,\r\n      loinc: loinc,\r\n      bodyType: bodyType,\r\n      nonXmlBody: nonXmlBody\r\n    };\r\n  \r\n    var date = parseDate(doc.tag('effectiveTime').attr('value'));\r\n    var title = Core.stripWhitespace(doc.tag('title').val());\r\n    \r\n    var author = doc.tag('author');\r\n    el = author.tag('assignedPerson').tag('name');\r\n    var name_dict = parseName(el);\r\n    \r\n    el = author.tag('addr');\r\n    var address_dict = parseAddress(el);\r\n    \r\n    el = author.tag('telecom');\r\n    var work_phone = el.attr('value');\r\n  \r\n    var documentation_of_list = [];\r\n    var performers = doc.tag('documentationOf').elsByTag('performer');\r\n    for (var i = 0; i < performers.length; i++) {\r\n      el = performers[i];\r\n      var performer_name_dict = parseName(el);\r\n      var performer_phone = el.tag('telecom').attr('value');\r\n      var performer_addr = parseAddress(el.tag('addr'));\r\n\r\n      var org = undefined;\r\n      var orgEl = el.tag('representedOrganization');\r\n      if (orgEl) {\r\n        org = {\r\n          name: orgEl.tag('name').val(),\r\n          phone: orgEl.tag('telecom').attr('value'),\r\n          address: parseAddress(orgEl.tag('addr'))\r\n        }\r\n      }\r\n\r\n      documentation_of_list.push({\r\n        name: performer_name_dict,\r\n        phone: {\r\n          work: performer_phone\r\n        },\r\n        address: performer_addr,\r\n        representedOrganization: org\r\n      });\r\n    }\r\n  \r\n    el = doc.tag('encompassingEncounter').tag('location');\r\n    var location_name = Core.stripWhitespace(el.tag('name').val());\r\n    var location_addr_dict = parseAddress(el.tag('addr'));\r\n    \r\n    var encounter_date = null;\r\n    el = el.tag('effectiveTime');\r\n    if (!el.isEmpty()) {\r\n      encounter_date = parseDate(el.attr('value'));\r\n    }\r\n    \r\n    data = {\r\n      type: docType,\r\n      date: date,\r\n      title: title,\r\n      author: {\r\n        name: name_dict,\r\n        address: address_dict,\r\n        phone: {\r\n          work: work_phone\r\n        }\r\n      },\r\n      documentation_of: documentation_of_list,\r\n      location: {\r\n        name: location_name,\r\n        address: location_addr_dict,\r\n        encounter_date: encounter_date\r\n      }\r\n    };\r\n    \r\n    return data;\r\n  };\r\n}","/*\r\n * Parser for the CCDA encounters section\r\n */\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n\r\n  self.encounters = function (ccda) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var encounters = ccda.section('encounters');\r\n  \r\n    var data = {}, el;\r\n    data.entries = [];\r\n    data.displayName = \"Encounters\";\r\n    data.templateId = encounters.tag('templateId').attr('root');\r\n    data.text = encounters.tag('text').val(true);\r\n    \r\n    encounters.entries().each(function(entry) {\r\n      \r\n      var date = parseDate(entry.tag('effectiveTime').attr('value'));\r\n      \r\n      el = entry.tag('code');\r\n      var name = el.attr('displayName'),\r\n          code = el.attr('code'),\r\n          code_system = el.attr('codeSystem'),\r\n          code_system_name = el.attr('codeSystemName'),\r\n          code_system_version = el.attr('codeSystemVersion');\r\n      \r\n      // translation\r\n      el = entry.tag('translation');\r\n      var translation_name = el.attr('displayName'),\r\n          translation_code = el.attr('code'),\r\n          translation_code_system = el.attr('codeSystem'),\r\n          translation_code_system_name = el.attr('codeSystemName');\r\n      \r\n      // performer\r\n      el = entry.tag('performer').tag('code');\r\n      var performer_name = el.attr('displayName'),\r\n          performer_code = el.attr('code'),\r\n          performer_code_system = el.attr('codeSystem'),\r\n          performer_code_system_name = el.attr('codeSystemName');\r\n    \r\n      // participant => location\r\n      el = entry.tag('participant');\r\n      var organization = el.tag('code').attr('displayName');\r\n      \r\n      var location_dict = parseAddress(el);\r\n      location_dict.organization = organization;\r\n  \r\n      // findings\r\n      var findings = [];\r\n      var findingEls = entry.elsByTag('entryRelationship');\r\n      for (var i = 0; i < findingEls.length; i++) {\r\n        el = findingEls[i].tag('value');\r\n        findings.push({\r\n          name: el.attr('displayName'),\r\n          code: el.attr('code'),\r\n          code_system: el.attr('codeSystem')\r\n        });\r\n      }\r\n      \r\n      data.entries.push({\r\n        date: date,\r\n        name: name,\r\n        code: code,\r\n        code_system: code_system,\r\n        code_system_name: code_system_name,\r\n        code_system_version: code_system_version,\r\n        findings: findings,\r\n        translation: {\r\n          name: translation_name,\r\n          code: translation_code,\r\n          code_system: translation_code_system,\r\n          code_system_name: translation_code_system_name\r\n        },\r\n        performer: {\r\n          name: performer_name,\r\n          code: performer_code,\r\n          code_system: performer_code_system,\r\n          code_system_name: performer_code_system_name\r\n        },\r\n        location: location_dict\r\n      });\r\n    });\r\n    \r\n    return data;\r\n  };\r\n}","/*\r\n * Parser for any freetext section (i.e., contains just a single <text> element)\r\n */\r\n\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function() {\r\n  var self = this;\r\n\r\n  self.free_text = function (ccda, sectionName) {    \r\n    var data = {};\r\n    \r\n    var doc = ccda.section(sectionName);\r\n    var text = Core.stripWhitespace(doc.tag('text').val(true));\r\n    \r\n    data = {\r\n      text: text\r\n    };\r\n\r\n    return data;\r\n  };\r\n}\r\n","/*\r\n * Parser for the CCDA functional & cognitive status\r\n */\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n\r\n  self.functional_statuses = function (ccda) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var data = [], el;\r\n  \r\n    var statuses = ccda.section('functional_statuses');\r\n  \r\n    statuses.entries().each(function(entry) {\r\n  \r\n      var date = parseDate(entry.tag('effectiveTime').attr('value'));\r\n      if (!date) {\r\n        date = parseDate(entry.tag('effectiveTime').tag('low').attr('value'));\r\n      }\r\n  \r\n      el = entry.tag('value');\r\n  \r\n      var name = el.attr('displayName'),\r\n          code = el.attr('code'),\r\n          code_system = el.attr('codeSystem'),\r\n          code_system_name = el.attr('codeSystemName');\r\n  \r\n      data.push({\r\n        date: date,\r\n        name: name,\r\n        code: code,\r\n        code_system: code_system,\r\n        code_system_name: code_system_name\r\n      });\r\n    \r\n    });\r\n    \r\n    return data;\r\n  };  \r\n}","/*\r\n * Parser for the CCDA immunizations section\r\n */\r\n\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n\r\n  self.immunizations = function (ccda) {    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var administeredData = {}, declinedData = {}, product, el;\r\n  \r\n    var immunizations = ccda.section('immunizations');\r\n  \r\n    administeredData.entries = [];\r\n    administeredData.displayName = \"Immunizations\";\r\n    administeredData.templateId = immunizations.tag('templateId').attr('root');\r\n    administeredData.text = immunizations.tag('text').val(true);\r\n  \r\n    declinedData.entries = [];\r\n    declinedData.displayName = \"Immunizations Declined\";\r\n    declinedData.templateId = immunizations.tag('templateId').attr('root');\r\n    declinedData.text = immunizations.tag('text').val(true);\r\n    \r\n    immunizations.entries().each(function(entry) {\r\n      \r\n      // date\r\n      el = entry.tag('effectiveTime');\r\n      var date = parseDate(el.attr('value'));\r\n      if (!date) {\r\n        date = parseDate(el.tag('low').attr('value'));\r\n      }\r\n  \r\n      // if 'declined' is true, this is a record that this vaccine WASN'T administered\r\n      el = entry.tag('substanceAdministration');\r\n      var declined = el.boolAttr('negationInd');\r\n  \r\n      // product\r\n      product = entry.template('2.16.840.1.113883.10.20.22.4.54');\r\n      el = product.tag('code');\r\n      var product_name = el.attr('displayName'),\r\n          product_code = el.attr('code'),\r\n          product_code_system = el.attr('codeSystem'),\r\n          product_code_system_name = el.attr('codeSystemName');\r\n  \r\n      // translation\r\n      el = product.tag('translation');\r\n      var translation_name = el.attr('displayName'),\r\n          translation_code = el.attr('code'),\r\n          translation_code_system = el.attr('codeSystem'),\r\n          translation_code_system_name = el.attr('codeSystemName');\r\n  \r\n      // misc product details\r\n      el = product.tag('lotNumberText');\r\n      var lot_number = el.val();\r\n  \r\n      el = product.tag('manufacturerOrganization');\r\n      var manufacturer_name = el.tag('name').val();\r\n      \r\n      // route\r\n      el = entry.tag('routeCode');\r\n      var route_name = el.attr('displayName'),\r\n          route_code = el.attr('code'),\r\n          route_code_system = el.attr('codeSystem'),\r\n          route_code_system_name = el.attr('codeSystemName');\r\n      \r\n      // instructions\r\n      el = entry.template('2.16.840.1.113883.10.20.22.4.20');\r\n      var instructions_text = Core.stripWhitespace(el.tag('text').val());\r\n      el = el.tag('code');\r\n      var education_name = el.attr('displayName'),\r\n          education_code = el.attr('code'),\r\n          education_code_system = el.attr('codeSystem');\r\n  \r\n      // dose\r\n      el = entry.tag('doseQuantity');\r\n      var dose_value = el.attr('value'),\r\n          dose_unit = el.attr('unit');\r\n      \r\n      var data = (declined) ? declinedData : administeredData;\r\n      data.entries.push({\r\n        date: date,\r\n        product: {\r\n          name: product_name,\r\n          code: product_code,\r\n          code_system: product_code_system,\r\n          code_system_name: product_code_system_name,\r\n          translation: {\r\n            name: translation_name,\r\n            code: translation_code,\r\n            code_system: translation_code_system,\r\n            code_system_name: translation_code_system_name\r\n          },\r\n          lot_number: lot_number,\r\n          manufacturer_name: manufacturer_name\r\n        },\r\n        dose_quantity: {\r\n          value: dose_value,\r\n          unit: dose_unit\r\n        },\r\n        route: {\r\n          name: route_name,\r\n          code: route_code,\r\n          code_system: route_code_system,\r\n          code_system_name: route_code_system_name\r\n        },\r\n        instructions: instructions_text,\r\n        education_type: {\r\n          name: education_name,\r\n          code: education_code,\r\n          code_system: education_code_system\r\n        }\r\n      });\r\n    });\r\n    \r\n    return {\r\n      administered: administeredData,\r\n      declined: declinedData\r\n    };\r\n  };\r\n}\r\n\r\n\r\n","/*\r\n * Parser for the CCDA \"plan of care\" section\r\n */\r\n\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function() {\r\n  var self = this;\r\n  \r\n  self.instructions = function (ccda) {\r\n    \r\n    var data = [], el;\r\n    \r\n    var instructions = ccda.section('instructions');\r\n    data.templateId = instructions.tag('templateId').attr('root');\r\n    \r\n    instructions.entries().each(function(entry) {\r\n  \r\n      el = entry.tag('code');\r\n      var name = el.attr('displayName'),\r\n          code = el.attr('code'),\r\n          code_system = el.attr('codeSystem'),\r\n          code_system_name = el.attr('codeSystemName');\r\n  \r\n      var text = Core.stripWhitespace(entry.tag('text').val(true));\r\n      \r\n      data.push({\r\n        text: text,\r\n        name: name,\r\n        code: code,\r\n        code_system: code_system,\r\n        code_system_name: code_system_name\r\n      });\r\n    });\r\n    \r\n    return data;\r\n  };\r\n}","/*\r\n * Parser for the CCDA medications section\r\n */\r\n\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function (doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n\r\n  self.medications = function (ccda) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var medications = ccda.section('medications');\r\n  \r\n    var data = {}, el;\r\n    data.entries = [];\r\n    data.displayName = \"Medications\";\r\n    data.templateId = medications.tag('templateId').attr('root');\r\n    data.text = medications.tag('text').val(true);\r\n  \r\n    medications.entries().each(function(entry) {\r\n      \r\n      el = entry.tag('text');\r\n      var sig = Core.stripWhitespace(el.val());\r\n  \r\n      var effectiveTimes = entry.elsByTag('effectiveTime');\r\n  \r\n      el = effectiveTimes[0]; // the first effectiveTime is the med start date\r\n      var start_date = null, end_date = null;\r\n      if (el) {\r\n        start_date = parseDate(el.tag('low').attr('value'));\r\n        end_date = parseDate(el.tag('high').attr('value'));\r\n      }\r\n  \r\n      // the second effectiveTime might the schedule period or it might just\r\n      // be a random effectiveTime from further in the entry... xsi:type should tell us\r\n      el = effectiveTimes[1];\r\n      var schedule_type = null, schedule_period_value = null, schedule_period_unit = null;\r\n      if (el && el.attr('xsi:type') === 'PIVL_TS') {\r\n        var institutionSpecified = el.attr('institutionSpecified');\r\n        if (institutionSpecified === 'true') {\r\n          schedule_type= 'frequency';\r\n        } else if (institutionSpecified === 'false') {\r\n          schedule_type = 'interval';\r\n        }\r\n  \r\n        el = el.tag('period');\r\n        schedule_period_value = el.attr('value');\r\n        schedule_period_unit = el.attr('unit');\r\n      }\r\n      \r\n      el = entry.tag('manufacturedProduct').tag('code');\r\n      var product_name = el.attr('displayName'),\r\n          product_code = el.attr('code'),\r\n          product_code_system = el.attr('codeSystem');\r\n  \r\n      var product_original_text = null;\r\n      el = entry.tag('manufacturedProduct').tag('originalText');\r\n      if (!el.isEmpty()) {\r\n        product_original_text = Core.stripWhitespace(el.val());\r\n      }\r\n      // if we don't have a product name yet, try the originalText version\r\n      if (!product_name && product_original_text) {\r\n        product_name = product_original_text;\r\n      }\r\n      \r\n      el = entry.tag('manufacturedProduct').tag('translation');\r\n      var translation_name = el.attr('displayName'),\r\n          translation_code = el.attr('code'),\r\n          translation_code_system = el.attr('codeSystem'),\r\n          translation_code_system_name = el.attr('codeSystemName');\r\n      \r\n      el = entry.tag('doseQuantity');\r\n      var dose_value = el.attr('value'),\r\n          dose_unit = el.attr('unit');\r\n      \r\n      el = entry.tag('rateQuantity');\r\n      var rate_quantity_value = el.attr('value'),\r\n          rate_quantity_unit = el.attr('unit');\r\n      \r\n      el = entry.tag('precondition').tag('value');\r\n      var precondition_name = el.attr('displayName'),\r\n          precondition_code = el.attr('code'),\r\n          precondition_code_system = el.attr('codeSystem');\r\n      \r\n      el = entry.template('2.16.840.1.113883.10.20.22.4.19').tag('value');\r\n      var reason_name = el.attr('displayName'),\r\n          reason_code = el.attr('code'),\r\n          reason_code_system = el.attr('codeSystem');\r\n      \r\n      el = entry.tag('routeCode');\r\n      var route_name = el.attr('displayName'),\r\n          route_code = el.attr('code'),\r\n          route_code_system = el.attr('codeSystem'),\r\n          route_code_system_name = el.attr('codeSystemName');\r\n      \r\n      // participant/playingEntity => vehicle\r\n      el = entry.tag('participant').tag('playingEntity');\r\n      var vehicle_name = el.tag('name').val();\r\n  \r\n      el = el.tag('code');\r\n      // prefer the code vehicle_name but fall back to the non-coded one\r\n      vehicle_name = el.attr('displayName') || vehicle_name;\r\n      var vehicle_code = el.attr('code'),\r\n          vehicle_code_system = el.attr('codeSystem'),\r\n          vehicle_code_system_name = el.attr('codeSystemName');\r\n      \r\n      el = entry.tag('administrationUnitCode');\r\n      var administration_name = el.attr('displayName'),\r\n          administration_code = el.attr('code'),\r\n          administration_code_system = el.attr('codeSystem'),\r\n          administration_code_system_name = el.attr('codeSystemName');\r\n      \r\n      // performer => prescriber\r\n      el = entry.tag('performer');\r\n      var prescriber_organization = el.tag('name').val(),\r\n          prescriber_person = null;\r\n      \r\n      data.entries.push({\r\n        date_range: {\r\n          start: start_date,\r\n          end: end_date\r\n        },\r\n        text: sig,\r\n        product: {\r\n          name: product_name,\r\n          code: product_code,\r\n          code_system: product_code_system,\r\n          text: product_original_text,\r\n          translation: {\r\n            name: translation_name,\r\n            code: translation_code,\r\n            code_system: translation_code_system,\r\n            code_system_name: translation_code_system_name\r\n          }\r\n        },\r\n        dose_quantity: {\r\n          value: dose_value,\r\n          unit: dose_unit\r\n        },\r\n        rate_quantity: {\r\n          value: rate_quantity_value,\r\n          unit: rate_quantity_unit\r\n        },\r\n        precondition: {\r\n          name: precondition_name,\r\n          code: precondition_code,\r\n          code_system: precondition_code_system\r\n        },\r\n        reason: {\r\n          name: reason_name,\r\n          code: reason_code,\r\n          code_system: reason_code_system\r\n        },\r\n        route: {\r\n          name: route_name,\r\n          code: route_code,\r\n          code_system: route_code_system,\r\n          code_system_name: route_code_system_name\r\n        },\r\n        schedule: {\r\n          type: schedule_type,\r\n          period_value: schedule_period_value,\r\n          period_unit: schedule_period_unit\r\n        },\r\n        vehicle: {\r\n          name: vehicle_name,\r\n          code: vehicle_code,\r\n          code_system: vehicle_code_system,\r\n          code_system_name: vehicle_code_system_name\r\n        },\r\n        administration: {\r\n          name: administration_name,\r\n          code: administration_code,\r\n          code_system: administration_code_system,\r\n          code_system_name: administration_code_system_name\r\n        },\r\n        prescriber: {\r\n          organization: prescriber_organization,\r\n          person: prescriber_person\r\n        }\r\n      });\r\n    });\r\n    \r\n    return data;\r\n  };\r\n}\r\n","/*\r\n * Parser for the CCDA problems section\r\n */\r\n\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n\r\n  self.problems = function (ccda) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n  \r\n    var problems = ccda.section('problems');\r\n  \r\n    var data = {}, el;\r\n    data.entries = [];\r\n    data.displayName = \"Problems\";\r\n    data.templateId = problems.tag('templateId').attr('root');\r\n    data.text = problems.tag('text').val(true);\r\n    \r\n    problems.entries().each(function(entry) {\r\n      \r\n      el = entry.tag('effectiveTime');\r\n      var start_date = parseDate(el.tag('low').attr('value')),\r\n          end_date = parseDate(el.tag('high').attr('value'));\r\n      \r\n      el = entry.template('2.16.840.1.113883.10.20.22.4.4').tag('value');\r\n      var name = el.attr('displayName'),\r\n          code = el.attr('code'),\r\n          code_system = el.attr('codeSystem'),\r\n          code_system_name = el.attr('codeSystemName');\r\n      \r\n      el = entry.template('2.16.840.1.113883.10.20.22.4.4').tag('translation');\r\n      var translation_name = el.attr('displayName'),\r\n        translation_code = el.attr('code'),\r\n        translation_code_system = el.attr('codeSystem'),\r\n        translation_code_system_name = el.attr('codeSystemName');\r\n      \r\n      el = entry.template('2.16.840.1.113883.10.20.22.4.6');\r\n      var status = el.tag('value').attr('displayName');\r\n      \r\n      var age = null;\r\n      el = entry.template('2.16.840.1.113883.10.20.22.4.31');\r\n      if (!el.isEmpty()) {\r\n        age = parseFloat(el.tag('value').attr('value'));\r\n      }\r\n  \r\n      el = entry.template('2.16.840.1.113883.10.20.22.4.64');\r\n      var comment = Core.stripWhitespace(el.tag('text').val());\r\n      \r\n      data.entries.push({\r\n        date_range: {\r\n          start: start_date,\r\n          end: end_date\r\n        },\r\n        name: name,\r\n        status: status,\r\n        age: age,\r\n        code: code,\r\n        code_system: code_system,\r\n        code_system_name: code_system_name,\r\n        translation: {\r\n          name: translation_name,\r\n          code: translation_code,\r\n          code_system: translation_code_system,\r\n          code_system_name: translation_code_system_name\r\n        },\r\n        comment: comment\r\n      });\r\n    });\r\n    \r\n    return data;\r\n  };\r\n}\r\n","/*\r\n * Parser for the CCDA procedures section\r\n */\r\n\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n\r\n  self.procedures = function (ccda) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var procedures = ccda.section('procedures');\r\n  \r\n    var data = {}, el;\r\n    data.entries = [];\r\n    data.displayName = \"Procedures\";\r\n    data.templateId = procedures.tag('templateId').attr('root');\r\n    data.text = procedures.tag('text').val(true);\r\n    \r\n    procedures.entries().each(function(entry) {\r\n      \r\n      el = entry.tag('effectiveTime');\r\n      var date = parseDate(el.attr('value'));\r\n      \r\n      el = entry.tag('code');\r\n      var name = el.attr('displayName'),\r\n          code = el.attr('code'),\r\n          code_system = el.attr('codeSystem');\r\n  \r\n      if (!name) {\r\n        name = Core.stripWhitespace(entry.tag('originalText').val());\r\n      }\r\n      \r\n      // 'specimen' tag not always present\r\n      el = entry.tag('specimen').tag('code');\r\n      var specimen_name = el.attr('displayName'),\r\n          specimen_code = el.attr('code'),\r\n          specimen_code_system = el.attr('codeSystem');\r\n      \r\n      el = entry.tag('performer').tag('addr');\r\n      var organization = el.tag('name').val(),\r\n          phone = el.tag('telecom').attr('value');\r\n      \r\n      var performer_dict = parseAddress(el);\r\n      performer_dict.organization = organization;\r\n      performer_dict.phone = phone;\r\n      \r\n      // participant => device\r\n      el = entry.template('2.16.840.1.113883.10.20.22.4.37').tag('code');\r\n      var device_name = el.attr('displayName'),\r\n          device_code = el.attr('code'),\r\n          device_code_system = el.attr('codeSystem');\r\n      \r\n      data.entries.push({\r\n        date: date,\r\n        name: name,\r\n        code: code,\r\n        code_system: code_system,\r\n        specimen: {\r\n          name: specimen_name,\r\n          code: specimen_code,\r\n          code_system: specimen_code_system\r\n        },\r\n        performer: performer_dict,\r\n        device: {\r\n          name: device_name,\r\n          code: device_code,\r\n          code_system: device_code_system\r\n        }\r\n      });\r\n    });\r\n    \r\n    return data;\r\n  };\r\n}","/*\r\n * Parser for the CCDA results (labs) section\r\n */\r\n\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n\r\n  self.results = function (ccda) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var results = ccda.section('results');\r\n  \r\n    var data = {}, el;\r\n    data.entries = [];\r\n    data.displayName = \"Results\";\r\n    data.templateId = results.tag('templateId').attr('root');\r\n    data.text = results.tag('text').val(true);\r\n    \r\n    results.entries().each(function(entry) {\r\n      \r\n      // panel\r\n      el = entry.tag('code');\r\n      var panel_name = el.attr('displayName'),\r\n          panel_code = el.attr('code'),\r\n          panel_code_system = el.attr('codeSystem'),\r\n          panel_code_system_name = el.attr('codeSystemName');\r\n      \r\n      var observation;\r\n      var tests = entry.elsByTag('observation');\r\n      var tests_data = [];\r\n      \r\n      for (var i = 0; i < tests.length; i++) {\r\n        observation = tests[i];\r\n        \r\n        var date = parseDate(observation.tag('effectiveTime').attr('value'));\r\n        \r\n        el = observation.tag('code');\r\n        var name = el.attr('displayName'),\r\n            code = el.attr('code'),\r\n            code_system = el.attr('codeSystem'),\r\n            code_system_name = el.attr('codeSystemName');\r\n  \r\n        if (!name) {\r\n          name = Core.stripWhitespace(observation.tag('text').val());\r\n        }\r\n        \r\n        el = observation.tag('translation');\r\n        var translation_name = el.attr('displayName'),\r\n          translation_code = el.attr('code'),\r\n          translation_code_system = el.attr('codeSystem'),\r\n          translation_code_system_name = el.attr('codeSystemName');\r\n      \r\n        el = observation.tag('value');\r\n        var value = el.attr('value'),\r\n            unit = el.attr('unit');\r\n        // We could look for xsi:type=\"PQ\" (physical quantity) but it seems better\r\n        // not to trust that that field has been used correctly...\r\n        if (value && !isNaN(parseFloat(value))) {\r\n          value = parseFloat(value);\r\n        }\r\n        if (!value) {\r\n          value = el.val(); // look for free-text values\r\n        }\r\n        \r\n        el = observation.tag('referenceRange');\r\n        var reference_range_text = Core.stripWhitespace(el.tag('observationRange').tag('text').val()),\r\n            reference_range_low_unit = el.tag('observationRange').tag('low').attr('unit'),\r\n            reference_range_low_value = el.tag('observationRange').tag('low').attr('value'),\r\n            reference_range_high_unit = el.tag('observationRange').tag('high').attr('unit'),\r\n            reference_range_high_value = el.tag('observationRange').tag('high').attr('value');\r\n        \r\n        tests_data.push({\r\n          date: date,\r\n          name: name,\r\n          value: value,\r\n          unit: unit,\r\n          code: code,\r\n          code_system: code_system,\r\n          code_system_name: code_system_name,\r\n          translation: {\r\n            name: translation_name,\r\n            code: translation_code,\r\n            code_system: translation_code_system,\r\n            code_system_name: translation_code_system_name\r\n          },\r\n          reference_range: {\r\n            text: reference_range_text,\r\n            low_unit: reference_range_low_unit,\r\n            low_value: reference_range_low_value,\r\n            high_unit: reference_range_high_unit,\r\n            high_value: reference_range_high_value,\r\n          }\r\n        });\r\n      }\r\n      \r\n      data.entries.push({\r\n        name: panel_name,\r\n        code: panel_code,\r\n        code_system: panel_code_system,\r\n        code_system_name: panel_code_system_name,\r\n        tests: tests_data\r\n      });\r\n    });\r\n    \r\n    return data;\r\n  };\r\n}","/*\r\n * Parser for the CCDA smoking status in social history section\r\n */\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n\r\n  self.smoking_status = function (ccda) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var data, el;\r\n  \r\n    var name = null,\r\n        code = null,\r\n        code_system = null,\r\n        code_system_name = null,\r\n        entry_date = null;\r\n  \r\n    // We can parse all of the social_history sections,\r\n    // but in practice, this section seems to be used for\r\n    // smoking status, so we're just going to break that out.\r\n    // And we're just looking for the first non-empty one.\r\n    var social_history = ccda.section('social_history');\r\n    var entries = social_history.entries();\r\n    for (var i=0; i < entries.length; i++) {\r\n      var entry = entries[i];\r\n  \r\n      var smoking_status = entry.template('2.16.840.1.113883.10.20.22.4.78');\r\n      if (smoking_status.isEmpty()) {\r\n        smoking_status = entry.template('2.16.840.1.113883.10.22.4.78');\r\n      }\r\n      if (smoking_status.isEmpty()) {\r\n        continue;\r\n      }\r\n  \r\n      el = smoking_status.tag('effectiveTime');\r\n      entry_date = parseDate(el.attr('value'));\r\n  \r\n      el = smoking_status.tag('value');\r\n      name = el.attr('displayName');\r\n      code = el.attr('code');\r\n      code_system = el.attr('codeSystem');\r\n      code_system_name = el.attr('codeSystemName');\r\n  \r\n      if (name) {\r\n        break;\r\n      }\r\n    }\r\n  \r\n    data = {\r\n      date: entry_date,\r\n      name: name,\r\n      code: code,\r\n      code_system: code_system,\r\n      code_system_name: code_system_name\r\n    };\r\n    \r\n    return data;\r\n  };  \r\n}","/*\r\n * Parser for the CCDA vitals section\r\n */\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n\r\n  self.vitals = function (ccda) {\r\n    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var vitals = ccda.section('vitals');\r\n  \r\n    var data = {}, el;\r\n    data.entries = [];\r\n    data.displayName = \"Vitals\";\r\n    data.templateId = vitals.tag('templateId').attr('root');\r\n    data.text = vitals.tag('text').val(true);\r\n  \r\n    vitals.entries().each(function(entry) {\r\n      \r\n      el = entry.tag('effectiveTime');\r\n      var entry_date = parseDate(el.attr('value'));\r\n      \r\n      var result;\r\n      var results = entry.elsByTag('component');\r\n      var results_data = [];\r\n      \r\n      for (var i = 0; i < results.length; i++) {\r\n        result = results[i];\r\n        \r\n        el = result.tag('code');\r\n        var name = el.attr('displayName'),\r\n            code = el.attr('code'),\r\n            code_system = el.attr('codeSystem'),\r\n            code_system_name = el.attr('codeSystemName');\r\n        \r\n        el = result.tag('value');\r\n        var value = parseFloat(el.attr('value')),\r\n            unit = el.attr('unit');\r\n        \r\n        results_data.push({\r\n          name: name,\r\n          code: code,\r\n          code_system: code_system,\r\n          code_system_name: code_system_name,\r\n          value: value,\r\n          unit: unit\r\n        });\r\n      }\r\n      \r\n      data.entries.push({\r\n        date: entry_date,\r\n        results: results_data\r\n      });\r\n    });\r\n    \r\n    return data;\r\n  };\r\n}","/*\r\n * Parser for the CCDAR2 document\r\n */\r\n\r\nvar ParseGenericInfo = require('./generic');\r\nvar Core = require('../core');\r\n\r\nvar DocumentParser = require('./ccdar2/document');\r\nvar DemographicsParser = require('./ccda/demographics');\r\nvar HealthConcernsParser = require('./ccdar2/health_concerns');\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n  self.documentParser = new DocumentParser(self.doc);\r\n  self.demographicsParser = new DemographicsParser(self.doc);\r\n  self.healthConcernsParser = new HealthConcernsParser(self.doc);\r\n\r\n  self.run = function (ccda) {    \r\n      var data = {};\r\n  \r\n      data.document              = self.documentParser.document(ccda);\r\n      data.demographics          = self.demographicsParser.demographics(ccda);\r\n      data.health_concerns_document  = self.healthConcernsParser.health_concerns_document(ccda);\r\n      data.json                  = Core.json;\r\n  \r\n      // Decorate each section with Title, templateId and text and adds missing sections\r\n      ParseGenericInfo(ccda, data);\r\n  \r\n      return data;\r\n    };\r\n}\r\n","/*\r\n * Parser for the CCDAR2 document section\r\n */\r\nvar Core = require('../../core');\r\n\r\nmodule.exports = function(doc) {\r\n  var self = this;\r\n  self.doc = doc;\r\n\r\n  self.document = function (ccda) {    \r\n    var parseDate = self.doc.parseDate;\r\n    var parseName = self.doc.parseName;\r\n    var parseAddress = self.doc.parseAddress;\r\n    var data = {}, el;\r\n  \r\n    var doc = ccda.section('document');\r\n    var date = parseDate(doc.tag('effectiveTime').attr('value'));\r\n    var title = Core.stripWhitespace(doc.tag('title').val());\r\n  \r\n    // Parse Doc Type Info\r\n    var templates =  doc.elsByTag('templateId');\r\n  \r\n    var rootTemplate = templates[0].attr('root');\r\n    var secondTemplate;\r\n    if(templates.length >1)\r\n      secondTemplate = templates[1].attr('root');\r\n    else\r\n      secondTemplate = rootTemplate;\r\n  \r\n    var loinc = doc.tag('code').attr('code');\r\n    var templateId = doc.tag('templateId').attr('root');\r\n    var displayName = doc.tag('code').attr('displayName');\r\n  \r\n    var nonXml = doc.tag('nonXMLBody');\r\n    var nonXmlNodes = nonXml.el.childNodes;\r\n  \r\n    var bodyType = \"structured\";\r\n    var nonXmlBody = {\r\n      type: \"\",\r\n      mediaType: \"\",\r\n      representation: \"\",\r\n      rawText: \"\",\r\n      reference: \"\"\r\n    };\r\n    if(nonXmlNodes && nonXmlNodes.length > 0) {\r\n      bodyType = \"unstructured\";\r\n      var text = nonXml.tag('text');\r\n      var mediaType = \"\";\r\n      var representation = \"\";\r\n      var rawText = \"\";\r\n      var reference = \"\";\r\n      var type = \"\";\r\n  \r\n      // We have an embedded doc\r\n      if(text && text.attr('mediaType')) {\r\n        mediaType = text.attr('mediaType');\r\n        representation = text.attr('representation');\r\n        rawText = text.val();\r\n        type = \"embedded\";\r\n      }\r\n  \r\n      if(text && !mediaType) {\r\n        reference = text.tag('reference').attr('value');\r\n        type = \"reference\";\r\n      }\r\n      nonXmlBody = {\r\n        type: type,\r\n        mediaType: mediaType,\r\n        representation: representation,\r\n        rawText: rawText,\r\n        reference: reference\r\n      }\r\n    }\r\n  \r\n    var docType = {\r\n      type: \"CCDAR2\",\r\n      rootTemplateId: rootTemplate,\r\n      templateId: secondTemplate,\r\n      displayName: displayName,\r\n      loinc: loinc,\r\n      bodyType: bodyType,\r\n      nonXmlBody: nonXmlBody\r\n    };\r\n  \r\n    var author = doc.tag('author');\r\n    el = author.tag('assignedPerson').tag('name');\r\n    var name_dict = parseName(el);\r\n  \r\n    el = author.tag('addr');\r\n    var address_dict = parseAddress(el);\r\n  \r\n    el = author.tag('telecom');\r\n    var work_phone = el.attr('value');\r\n  \r\n    var documentation_of_list = [];\r\n    var performers = doc.tag('documentationOf').elsByTag('performer');\r\n    for (var i = 0; i < performers.length; i++) {\r\n      el = performers[i];\r\n      var performer_name_dict = parseName(el);\r\n      var performer_phone = el.tag('telecom').attr('value');\r\n      var performer_addr = parseAddress(el.tag('addr'));\r\n      documentation_of_list.push({\r\n        name: performer_name_dict,\r\n        phone: {\r\n          work: performer_phone\r\n        },\r\n        address: performer_addr\r\n      });\r\n    }\r\n  \r\n    el = doc.tag('encompassingEncounter').tag('location');\r\n    var location_name = Core.stripWhitespace(el.tag('name').val());\r\n    var location_addr_dict = parseAddress(el.tag('addr'));\r\n  \r\n    var encounter_date = null;\r\n    el = el.tag('effectiveTime');\r\n    if (!el.isEmpty()) {\r\n      encounter_date = parseDate(el.attr('value'));\r\n    }\r\n  \r\n    data = {\r\n      type: docType,\r\n      date: date,\r\n      title: title,\r\n      author: {\r\n        name: name_dict,\r\n        address: address_dict,\r\n        phone: {\r\n          work: work_phone\r\n        }\r\n      },\r\n      documentation_of: documentation_of_list,\r\n      location: {\r\n        name: location_name,\r\n        address: location_addr_dict,\r\n        encounter_date: encounter_date\r\n      }\r\n    };\r\n  \r\n    return data;\r\n  };\r\n}"],"sourceRoot":""}